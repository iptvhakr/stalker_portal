/*! stb-app: v1.4.8 (webpack: v1.13.0) */
!function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";var n=i(3);n.addListeners({load:function(){var e=(i(33),i(18)),t=i(5),s=i(12),a=i(13);n.network=a(s),e.load({name:core.environment.language},function(e){t.init([i(17)]),t.navigate("pageMain"),setTimeout(function(){window.parent!==window&&n.show()},300)})}})},function(e,t,i){"use strict";function n(e){var t,i=this;if(e=e||{},this.visible=!0,this.focusable=!0,this.$node=null,this.$body=null,this.parent=null,this.children=[],this.propagate=!!e.propagate,s.call(this,e.data),this.$node=e.$node||document.createElement("div"),this.$body=e.$body||this.$node,this.$node.className+=" component "+(e.className||""),this.id=e.id||this.$node.id||"cid"+o++,e.parent&&e.parent.add(this),e.visible===!1&&this.hide(),e.focusable===!1&&(this.focusable=!1),this.defaultEvents){e.events=e.events||{};for(t in this.defaultEvents)e.events[t]=e.events[t]||this.defaultEvents[t]}e.events&&this.addListeners(e.events),e.children&&this.add.apply(this,e.children),this.$node.addEventListener("click",function(e){0===e.button&&(i.focus(),i.events.click&&i.emit("click",{event:e})),e.stopPropagation()})}var s=i(4),a=i(5),o=0;n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.defaultEvents=null,n.prototype.add=function(e){var t;for(t=0;t<arguments.length;t++)e=arguments[t],this.children.push(e),e.parent=this,e.$node&&null===e.$node.parentNode&&this.$body.appendChild(e.$node),this.events.add&&this.emit("add",{item:e})},n.prototype.remove=function(){this.parent&&(a.current.activeComponent===this&&(this.blur(),this.parent.focus()),this.parent.children.splice(this.parent.children.indexOf(this),1)),this.children.forEach(function(e){e.remove()}),this.removeAllListeners(),this.$node.parentNode.removeChild(this.$node),this.events.remove&&this.emit("remove")},n.prototype.focus=function(e){var t=a.current,i=t.activeComponent;return this.focusable&&this!==i?(i&&i.blur(),t.activeComponent=i=this,i.$node.classList.add("focus"),i.events.focus&&i.emit("focus",e),!0):!1},n.prototype.blur=function(){var e=a.current,t=e.activeComponent;return this.$node.classList.remove("focus"),this===t?(e.activeComponent=null,this.events.blur&&this.emit("blur"),!0):!1},n.prototype.show=function(e){return this.visible?!0:(this.$node.classList.remove("hidden"),this.visible=!0,this.events.show&&this.emit("show",e),!0)},n.prototype.hide=function(){return this.visible?(this.$node.classList.add("hidden"),this.visible=!1,this.events.hide&&this.emit("hide"),!0):!0},e.exports=n},function(e,t){"use strict";e.exports={back:8,"delete":46,channelPrev:1009,channelNext:9,ok:13,exit:27,up:38,down:40,left:37,right:39,pageUp:33,pageDown:34,end:35,home:36,volumeUp:107,volumeDown:109,f1:112,f2:113,f3:114,f4:115,refresh:116,frame:117,phone:119,set:120,tv:121,menu:122,web:123,mic:2032,rewind:2066,forward:2070,app:2076,usbMounted:2080,usbUnmounted:2081,playPause:2082,stop:2083,power:2085,record:2087,info:2089,mute:2192,clock:2032,audio:2071,keyboard:2076}},function(e,t,i){"use strict";var n,s,a,o,l=i(19),r=i(5),c=i(2),d=i(32),u={};i(20),window.core=window.parent.getCoreInstance(window),window.core.once("load",function(){n.data.time.load&&n.defaultEvents.load({type:"load"})}),window.parent&&window.parent.gSTB&&(window.dvbManager=window.parent.dvbManager,window.epgManager=window.parent.epgManager,window.gSTB=window.parent.gSTB,window.pvrManager=window.parent.pvrManager,window.stbDownloadManager=window.parent.stbDownloadManager,window.stbStorage=window.parent.stbStorage,window.stbUpdate=window.parent.stbUpdate,window.stbUPnP=window.parent.stbUPnP,window.stbWebWindow=window.parent.stbWebWindow,window.stbWindowMgr=window.parent.stbWindowMgr,window.timeShift=window.parent.timeShift),n=new l({debug:!1,host:!0,screen:null,time:{init:+new Date,load:0,done:0}}),n.setScreen=function(e){return e?(e.availHeight=e.height-(e.availTop+e.availBottom),e.availWidth=e.width-(e.availLeft+e.availRight),window.moveTo(0,0),window.resizeTo(e.width,e.height),a&&a instanceof HTMLLinkElement&&document.head.removeChild(a),o&&o instanceof HTMLLinkElement&&document.head.removeChild(o),o=document.createElement("link"),o.rel="stylesheet",o.href=window.core.theme.path+e.height+".css?"+ +new Date,document.head.appendChild(o),a=document.createElement("link"),a.rel="stylesheet",a.href="css/release."+e.height+".css?"+ +new Date,document.head.appendChild(a),this.data.metrics=e,!0):!1},n.setScreen(d[screen.height]||d[720]);for(s in c)"volumeUp"!==s&&"volumeDown"!==s&&(u[c[s]]=!0);n.defaultEvents={load:function(e){n.data.time.load=e.timeStamp,window.core.ready&&(n.events[e.type]&&n.emit(e.type,e),r.pages.forEach(function(t){t.events[e.type]&&t.emit(e.type,e)}),n.data.time.done=+new Date,n.events.done&&n.emit("done",e))},unload:function(e){n.events[e.type]&&n.emit(e.type,e),r.pages.forEach(function(t){t.events[e.type]&&t.emit(e.type,e)})},error:function(e){},keydown:function(e){var t,i=r.current,s={keyCode:e.keyCode,stop:e.stop,shiftKey:e.shiftKey,altKey:e.altKey,type:e.type,"native":e};0!==s.keyCode&&(s.code=s.keyCode,s.shiftKey&&(s.code+=1e3),s.altKey&&(s.code+=2e3),t=i.activeComponent,t&&t!==i&&(t.events[s.type]&&t.emit(s.type,s),!s.stop&&t.propagate&&t.parent&&t.parent.events[s.type]&&t.parent.emit(s.type,s)),s.stop||(i.events[s.type]&&i.emit(s.type,s),s.stop||n.events[s.type]&&n.emit(s.type,s)),n.data.host&&u[s.code]&&e.preventDefault())},keypress:function(e){var t=r.current;t.activeComponent&&t.activeComponent!==t&&t.activeComponent.events[e.type]&&t.activeComponent.emit(e.type,e)},click:function(e){},contextmenu:function(e){e.preventDefault()},mousewheel:function(e){var t=r.current;t.activeComponent&&t.activeComponent!==t&&t.activeComponent.events[e.type]&&t.activeComponent.emit(e.type,e),e.stop||t.events[e.type]&&t.emit(e.type,e)}};for(s in n.defaultEvents)window.addEventListener(s,n.defaultEvents[s]);n.show=function(){this.events.show&&this.emit("show"),window.core.call("app:ready")},n.exit=function(e){var t,s=i(10),a=i(9),o=r.current.activeComponent;r.current.add(t=new s({title:gettext("Exit"),events:{show:function(){this.children[0].focus()},hide:function(){o.focus()}},children:[new a({size:2,focusIndex:0,data:[{items:[{value:gettext("Exit")}],click:function(){return"function"==typeof e&&e(!0)?(t.hide(),void t.remove()):(n.events.exit&&n.emit("exit"),t.hide(),t.remove(),void core.call("exit"))}},{items:[{value:gettext("Cancel")}],click:function(){"function"==typeof e&&e(!1),t.hide(),t.remove()}}],events:{keydown:function(i){a.prototype.defaultEvents.keydown.call(this,i),i.code===c.back&&(i.stop=!0,"function"==typeof e&&e(!1),t.hide(),t.remove())}}})]})),t.show(),t.focus()},window.gSTB&&gSTB.SetNativeStringMode&&gSTB.SetNativeStringMode(!0),e.exports=n},function(e,t,i){"use strict";function n(){this.events={}}n.prototype={addListener:function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)},once:function(e,t){var i=this;this.events[e]=this.events[e]||[],this.events[e].push(function n(){t.apply(this,arguments),i.removeListener(e,n)})},addListeners:function(e){var t;if("object"==typeof e)for(t in e)e.hasOwnProperty(t)&&this.addListener(t,e[t])},removeListener:function(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(function(e){return e!==t}),0===this.events[e].length&&(this.events[e]=void 0))},removeAllListeners:function(e){0===arguments.length?this.events={}:e&&(this.events[e]=void 0)},emit:function(e,t,i){var n,s=this.events[e];if(s)for(n=0;n<s.length;n++)s[n].apply(this,Array.prototype.slice.call(arguments,1))}},n.prototype.constructor=n,e.exports=n},function(e,t,i){"use strict";var n,s=i(4);n=new s,n.current=null,n.history=[],n.pages=[],n.ids={},n.init=function(e){var t,i,n;if(e){for(this.pages=[],this.pages=e,t=0,i=e.length;i>t;t++)n=e[t],this.ids[n.id]=n,n.active&&(this.current=n);return this.events.init&&this.emit("init",{pages:e}),!0}return!1},n.parse=function(e){var t={name:"",data:[]};return t.data=e.split("/").map(decodeURIComponent),t.name=t.data.shift().slice(1),t},n.stringify=function(e,t){return t=Array.isArray(t)?t:[],e=encodeURIComponent(e),t=t.map(encodeURIComponent),t.unshift(e),t.join("/")},n.show=function(e,t){return e&&!e.active?(e.$node.classList.add("active"),e.active=!0,this.current=e,e.events.show&&e.emit("show",{page:e,data:t}),!0):!1},n.hide=function(e){return e&&e.active?(e.$node.classList.remove("active"),e.active=!1,this.current=null,e.events.hide&&e.emit("hide",{page:e}),!0):!1},n.navigate=function(e,t){var i=this.current,n=this.ids[e];return n&&!n.active?(location.hash=this.stringify(e,t),this.hide(this.current),this.show(n,t),this.events.navigate&&this.emit("navigate",{from:i,to:n}),this.history.push(n),!0):!1},n.back=function(){var e,t;return this.history.length>1&&(e=this.history.pop(),t=this.history[this.history.length-1],t&&!t.active)?(location.hash=t.id,this.hide(this.current),this.show(t),this.events.navigate&&this.emit("navigate",{from:e,to:t}),!0):!1},e.exports=n},function(e,t,i){"use strict";function n(e){e=e||{},this.$focusItem=null,this.viewIndex=null,this.data=[],this.type=this.TYPE_VERTICAL,this.size=5,this.cycle=!1,this.scroll=null,e.type&&(this.type=e.type),this.provider=null,e.className="list "+(e.className||""),this.type===this.TYPE_HORIZONTAL&&(e.className+=" horizontal"),a.call(this,e),this.init(e)}function s(e){var t,i;for(t=0;t<e.length;t++)i=e[t],"object"!=typeof i&&(i=e[t]={value:e[t]});return e}var a=i(1),o=i(2);n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.prototype.TYPE_VERTICAL=1,n.prototype.TYPE_HORIZONTAL=2,n.prototype.renderItemDefault=function(e,t){e.innerText=t.value},n.prototype.renderItem=n.prototype.renderItemDefault,n.prototype.defaultEvents={mousewheel:function(e){this.type===this.TYPE_VERTICAL&&e.wheelDeltaY&&this.move(e.wheelDeltaY>0?o.up:o.down),this.type===this.TYPE_HORIZONTAL&&e.wheelDeltaX&&this.move(e.wheelDeltaX>0?o.left:o.right)},keydown:function(e){switch(e.code){case o.up:case o.down:case o.right:case o.left:case o.pageUp:case o.pageDown:case o.home:case o.end:this.move(e.code);break;case o.ok:this.events["click:item"]&&this.$focusItem&&this.emit("click:item",{$item:this.$focusItem,event:e})}}},n.prototype.init=function(e){var t,i,n=this,s=this.$body.children.length,a=function(e){this.data&&(n.focusItem(this),n.events["click:item"]&&n.emit("click:item",{$item:this,event:e}))};if(void 0!==e.cycle&&(this.cycle=e.cycle),e.scroll&&(this.scroll=e.scroll),e.provider&&(this.provider=e.provider),e.render&&(this.renderItem=e.render),e.size&&(this.size=e.size),this.size!==s)for(s>0&&(this.$body.innerText=null),i=0;i<this.size;i++)t=document.createElement("div"),t.index=i,t.className="item",t.addEventListener("click",a),this.$body.appendChild(t);void 0!==e.viewIndex,this.viewIndex=null,this.provider?this.provider.get(null,function(t,i){t?n.events["data:error"]&&n.emit("data:error",t):(i&&(e.data=i,n.setData(e),n.scroll&&n.scroll.init({realSize:n.provider.maxCount,viewSize:n.provider.size,value:n.provider.head+n.provider.pos})),n.events["data:get"]&&n.emit("data:get"))}):e.data&&this.setData(e)},n.prototype.setData=function(e){e.data&&(this.data=s(e.data)),this.viewIndex=null,this.$focusItem&&this.blurItem(this.$focusItem),this.scroll&&!this.provider&&this.scroll.init({realSize:this.data.length,viewSize:this.size,value:e.viewIndex||0}),void 0!==e.focusIndex&&this.data.length?this.focusIndex(e.focusIndex):this.renderView(e.viewIndex||0)},n.prototype.renderView=function(e){var t,i,n,s,a;if(this.viewIndex!==e){for(s=this.viewIndex,this.viewIndex=a=e,i=0;i<this.size;i++)t=this.$body.children[i],n=this.data[e],n?(t.data=n,t.index=e,this.renderItem(t,n),n.mark?t.classList.add("mark"):t.classList.remove("mark")):(t.data=t.index=void 0,t.innerHTML="&nbsp;",t.ready=!1),e++;return this.events["move:view"]&&this.emit("move:view",{prevIndex:s,currIndex:a}),this.events["select:item"]&&this.emit("select:item",{$item:t}),this.scroll&&this.scroll.scrollTo(this.provider?this.provider.head+this.provider.pos:this.viewIndex),!0}return!1},n.prototype.move=function(e){var t=this,i=!1;if(this.data.length)switch(e){case o.left:if(this.type!==this.TYPE_HORIZONTAL)break;i=!0;case o.up:(i||this.type===this.TYPE_VERTICAL)&&(this.$focusItem&&this.$focusItem.index>0?this.$focusItem===this.$body.firstChild?this.renderView(this.viewIndex-1):this.focusItem(this.$focusItem.previousSibling):this.provider?this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n||0===n?n:t.$focusItem.index})}):(this.cycle&&this.move(o.end),this.events.overflow&&this.emit("overflow",{direction:e,cycle:this.cycle})));break;case o.right:if(this.type!==this.TYPE_HORIZONTAL)break;i=!0;case o.down:(i||this.type===this.TYPE_VERTICAL)&&(this.$focusItem&&this.$focusItem.index<this.data.length-1?this.$focusItem===this.$body.lastChild?this.renderView(this.viewIndex+1):this.focusItem(this.$focusItem.nextSibling):this.provider?this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n||0===n?n:t.$focusItem.index})}):(this.cycle&&this.move(o.home),this.events.overflow&&this.emit("overflow",{direction:e,cycle:this.cycle})));break;case o.pageUp:if(this.provider)return void this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n?n:0})});this.viewIndex<this.size?this.renderView(0):this.renderView(this.viewIndex-this.size+1),this.focusItem(this.$body.firstChild);break;case o.pageDown:if(this.provider){this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n||0===n?n:i.length<t.size?i.length-1:t.size-1})});break}this.data.length>this.size?(this.viewIndex>this.data.length-2*this.size?this.renderView(this.data.length-this.size):this.renderView(this.viewIndex+this.size-1),this.focusItem(this.$body.lastChild)):this.focusItem(this.$body.children[this.data.length-1]);break;case o.home:if(this.provider){this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n?n:0})});break}this.renderView(0),this.focusItem(this.$body.firstChild);break;case o.end:if(this.provider){this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n||0===n?n:i.length<t.size?i.length-1:t.size-1})});break}this.data.length>this.size?(this.renderView(this.data.length-this.size),this.focusItem(this.$body.lastChild)):this.focusItem(this.$body.children[this.data.length-1])}},n.prototype.focusItem=function(e){var t=this.$focusItem;return e&&t!==e?(null!==t&&(t.classList.remove("focus"),this.events["blur:item"]&&this.emit("blur:item",{$item:t})),this.$focusItem=e,this.$focusItem.data=this.data[this.$focusItem.index],e.classList.add("focus"),this.events["focus:item"]&&this.emit("focus:item",{$prev:t,$curr:e}),this.events["select:item"]&&this.emit("select:item",{$item:e}),!0):!1},n.prototype.blurItem=function(e){return e?(e===this.$focusItem&&(this.$focusItem=null),e.classList.remove("focus"),this.events["blur:item"]&&this.emit("blur:item",{$item:e}),!0):!1},n.prototype.focusIndex=function(e){var t=this.viewIndex||0;e>=t+this.size?(e=e<this.data.length-1?e:this.data.length-1,this.renderView(e-this.size+1),this.focusItem(this.$body.lastChild)):t>e?(e=e>0?e:0,this.renderView(e),this.focusItem(this.$body.firstChild)):(null===this.viewIndex&&this.renderView(0),this.focusItem(this.$body.children[e-t]))},n.prototype.markItem=function(e,t){t?e.classList.add("mark"):e.classList.remove("mark"),e.data.mark=t},e.exports=n},function(e,t){"use strict";var i={};i.tag=function(e,t,i){var n,s,a=null;if(e){if(a=document.createElement(e),t&&"object"==typeof t)for(s in t)a[s]=t[s];for(n=2;n<arguments.length;n++)arguments[n]&&a.appendChild("object"==typeof arguments[n]?arguments[n]:document.createTextNode(arguments[n]))}return a},i.fragment=function(e){var t,i=document.createDocumentFragment();for(t=0;t<arguments.length;t++)e=arguments[t],e&&i.appendChild("object"==typeof e?e:document.createTextNode(e));return i},i.add=function(e,t){var i;if(e instanceof Node){for(i=1;i<arguments.length;i++)arguments[i]&&e.appendChild("object"==typeof arguments[i]?arguments[i]:document.createTextNode(arguments[i]));return e}return null},i.remove=function(e){var t,i=0;for(t=0;t<arguments.length;t++)arguments[t]&&arguments[t].parentNode&&arguments[t].parentNode.removeChild(arguments[t])===arguments[t]&&i++;return arguments.length>0&&i===arguments.length},e.exports=i},function(e,t,i){"use strict";function n(e){e=e||{},e.className="checkBox "+(e.className||""),this.value=!!e.value,this.value&&(e.className+=" checked"),s.call(this,e),this.group=null,e.group&&(this.group=e.group,void 0===o[e.group]?o[e.group]=[this]:o[e.group].push(this))}var s=i(1),a=i(2),o={};n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.defaultEvents={click:function(){this.set(!this.value)},keydown:function(e){e.code===a.ok&&this.set(!this.value)}},n.prototype.set=function(e){var t,i;if(this.value!==e){if(!this.value&&null!==this.group)for(t=0,i=o[this.group].length;i>t;t++)o[this.group][t].set(!1);return this.value=!this.value,this.$node.classList.toggle("checked"),this.events.change&&this.emit("change",{value:this.value}),!0}return!1},e.exports=n},function(e,t,i){"use strict";function n(e){var t=this;e=e||{},this.handlers={},this.$noData=null,e.className="layoutList "+(e.className||""),e.propagate=e.propagate||!0,this.fixedData=e.fixedData||!1,e.$body=document.createElement("div"),e.$body.className="body",this.$noData=document.createElement("div"),this.$noData.className="noData hidden",s.call(this,e),this.$node.appendChild(this.$body),this.$node.appendChild(this.$noData),this.addListener("click:item",function(e){e.$item.layout.children.length&&!e.inner&&e.$item.layout.children[e.$item.layout.focusIndex].focus(),e.inner&&(t.focus(),t.focusItem(e.$item)),t.handlers[e.$item.index]&&t.handlers[e.$item.index](e.$item)})}var s=i(6),a=i(26);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.renderItemDefault=function(e,t){var i,n;if(e.ready&&this.fixedData&&!e.innerHTML.length)for(n=0;n<t.items.length;n++)"string"==typeof t.items[n].value&&(e.layout.$node.childNodes[n].innerText=t.items[n].value,e.layout.$node.childNodes[n].className=t.items[n].className);else{for(;e.firstChild;)e.removeChild(e.firstChild);i=new a({focusable:!1,data:t.items}),e.appendChild(i.$node),e.layout=i,i.parent=this,i.$parentItem=e,i.addListener("click",function(){this.parent.emit("click:item",{$item:e,inner:!0})}),t.click&&(this.handlers[e.index]=t.click),e.ready=!0}e.value=t.value||{}},n.prototype.setData=function(e){s.prototype.setData.call(this,e),e.data&&e.data.length?this.$noData.classList.add("hidden"):this.$noData.classList.remove("hidden")},n.prototype.init=function(e){var t;s.prototype.init.call(this,e),e.noData&&(this.$noData.innerHTML="",e.noData instanceof Element?this.$noData.appendChild(e.noData):"string"==typeof e.noData&&(t=document.createElement("div"),t.innerText=e.noData,this.$noData.appendChild(t)))},n.prototype.renderItem=n.prototype.renderItemDefault,e.exports=n},function(e,t,i){"use strict";function n(e){var t;e=e||{},e.focusable=e.focusable||!1,e.className="modalMessage "+(e.className||""),e.visible=e.visible||!1,e.$body=document.createElement("div"),e.$body.className="body",s.call(this,e),this.$node.appendChild(document.createElement("div")),this.$node.firstChild.classList.add("alignBox"),this.$node.firstChild.appendChild(document.createElement("div")),this.$header=document.createElement("div"),this.$header.className="header",this.$text=this.$header.appendChild(document.createElement("div")),this.$text.classList.add("text"),this.$text.innerText=e.title||"",e.icon&&(this.$icon=this.$header.appendChild(document.createElement("div")),this.$icon.className="icon "+e.icon),t=document.createElement("div"),t.className="overlay",this.$node.firstChild.firstChild.appendChild(this.$header),this.$node.firstChild.firstChild.appendChild(this.$body),this.$node.firstChild.firstChild.appendChild(t)}var s=i(1);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.focus=function(){this.$node.classList.add("active"),s.prototype.focus.call(this),this.children[0]&&this.children[0]instanceof s&&this.children[0].focus()},n.prototype.blur=function(){this.$node.classList.remove("active"),s.prototype.blur.call(this)},e.exports=n},function(e,t,i){"use strict";function n(e){e=e||{},this.active=!1,this.activeComponent=null,e.className="page "+(e.className||""),s.call(this,e),this.active=this.$node.classList.contains("active"),null===this.$node.parentNode&&document.body.appendChild(this.$node),this.page=this}var s=i(1);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n},function(e,t){"use strict";e.exports={mountPath:"/ram/mnt",registerTypes:["mpg","mpeg","mkv","avi","3gp","ts","tspinf","m4a","mp3","mp4","ac3","mov","vob","wav","ape","mts","m2t","m2v","ogg","oga","divx","aiff","m2ts","wv","m2p","tp","flv","tta","mod","tod","asf","wma","wmv","flac","ape","cue","iso","aac","txt","srt","sub","ass","m4v","tts","m3u","m3u8"]}},function(e,t){"use strict";function i(e){var t,i=[],n=this;try{t=JSON.parse(gSTB.GetSmbGroups())}catch(s){throw new Error("[Network]::getGroups()> parsing gSTB.GetSmbGroups() failed")}t&&Array.isArray(t.result)&&t.result.length>0?(t.result.forEach(function(e){e&&i.push({name:e,uri:e,type:n.types.SAMBA_GROUP})}),e(null,i)):e({message:"Invalid data"})}function n(e,t){var i,n,s;if("function"!=typeof t)throw new Error("[Network]::getServers()> callback must be a function");i=[],n=this;try{s=JSON.parse(gSTB.GetSmbServers(JSON.stringify({group:e.group})))}catch(a){throw new Error("[Network]::getServers()> parsing gSTB.GetSmbServers() failed")}s&&Array.isArray(s.result)&&s.result.length>0?(s.result.forEach(function(t){t&&i.push({name:t,uri:e.uri+"/"+t,type:n.types.SAMBA_HOST})}),t(null,i)):t({message:"Invalid data"})}function s(e,t){var i,n,s;if("function"!=typeof t)throw new Error("[Network]::getShares()> callback must be a function");i=[],n=this;try{s=JSON.parse(gSTB.GetSmbShares(JSON.stringify({server:e})))}catch(a){throw new Error("[Network]::getShares()> parsing gSTB.GetSmbShares() failed")}s&&s.result&&Array.isArray(s.result.shares)&&s.result.shares.length>0?(s.result.shares.forEach(function(e){var t;e&&(t=s.result.serverIP,i.push({name:e,address:"//"+t+"/"+e,server:t,type:n.types.SAMBA_SHARE}))}),t(null,i)):t({message:"Invalid data"})}e.exports=function(e){return{config:e,types:{SAMBA_GROUP:0,SAMBA_HOST:1,SAMBA_SHARE:2},getGroups:i,getServers:n,getShares:s}}},function(e,t){!function(){"use strict";var t={mediaType:{},mediaAction:{ACTION_RESET_FILTERS:0,ACTION_DELETE_FS:1,ACTION_DELETE_SMB:2,ACTION_CREATE_FOLDER:3,ACTION_MANUAL_ADD_SHARE:4,ACTION_TOGGLE_FAV:5,ACTION_CLEAR_FAV:6,ACTION_RENAME_SMB:7,ACTION_SEARCH:8}};e.exports=t}()},function(e,t){"use strict";function i(){this.TYPE_FOLDER=n.TYPE_FOLDER,this.TYPE_AUDIO=n.TYPE_AUDIO,this.TYPE_VIDEO=n.TYPE_VIDEO,this.TYPE_IMAGE=n.TYPE_IMAGE}var n=window.stbUPnP,s=!1;s||(n&&n.init(),s=!0),i.prototype.openRoot=function(e,t,i){var s,a;if("function"!=typeof i)throw new Error("[UPnP::openRoot()] callback must be a function");s=n.getServerListSync(),a=[],s&&Array.isArray(s)&&s.length>0?(s.forEach(function(e){a.push({name:e.FriendlyName,url:e.UDN,type:7.2})}),setTimeout(function(){i(null,a)},0)):setTimeout(function(){i({message:"Unable to get UPnP group servers"})},0)},i.prototype.openServer=function(e,t){if("function"!=typeof t)throw new Error("[UPnP::openServer()] callback must be a function");n.onOpenServer=function(e,i){i?t(i):t(null,e)},n.openServer(e)},i.prototype.openContext=function(e,t){if("function"!=typeof t)throw new Error("[UPnP::openContext()] callback must be a function");n.onOpenContext=function(e,i){i?t(i):t(null,e)},n.openContext(e)},e.exports=function(e){return new i(e)}},function(e,t){!function(){"use strict";function t(e,t){function i(e,t){var i=1024,n=1024*i,s=1024*n,a=1024*s;return e>=0&&i>e?e+" B":e>=i&&n>e?(e/i).toFixed(t)+" KB":e>=n&&s>e?(e/n).toFixed(t)+" MB":e>=s&&a>e?(e/s).toFixed(t)+" GB":e>=a?(e/a).toFixed(t)+" TB":e+" B"}return{overview:i(t,1)+" / "+i(e,1),singleObject:i(e,1)}}e.exports=t}()},function(e,t,i){"use strict";function n(e,t){if("dvd"===t.type){var i=e.path||M(Pe.slice(2===Pe.type?4:0));core.intent({action:"play",mime:"content/video",data:{title:e.name,uri:i,solution:"extBDDVD"},events:{}},function(e,t){Q=t})}}function s(e,t){Ae.mount(e,t)}function a(e){var t=e.path||M(Pe.slice(2===Pe.type?4:0))+e.name;Ae.readFile(t,function(e,i){var n=u(i),s=n.files[0].name.replace(/^[^.]+\./,""),a=[];n.files.forEach(function(e){e.tracks.forEach(function(i){var o={name:i.number+". "+i.title,type:"AUDIO"===i.type?6:5,ext:s,time:i.index[i.index.length-1]||0,url:t+"/"+e.name};n.files.length>1&&(o.file=e.name),i.performer!==n.performer&&void 0!==i.performer&&(o.performer=i.performer),a.push(o)})}),Pe.push({index:Z.$focusItem.index,path:Z.$focusItem.data.value.name}),w(Z,y({dirs:[],files:a},1),7,7,te,{focusIndex:0})})}function o(e){var t=e.path||M(Pe.slice(2===Pe.type?4:0))+e.name;return Ae.readFile(t,function(e,t){var i=h(t);i.items=i.items.filter(function(e){var t;for(t in He)if(~He[t].ext.indexOf(e.ext||""))return e.type=t,e.subtype=e.ext?re.playlistFile:re.playlistStream,!0;return!1}),Pe.push({index:Z.$focusItem.index,path:Z.$focusItem.data.value.name,isDisplayPlaylist:!0}),Pe.currentDirFilesCount=i.items.length,w(Z,y({dirs:[],files:i.items},1),7,7,te,{focusIndex:0})}),!1}function l(e){var t;t=e.path.split(" "),t.length>1&&(e.solution=t[0],e.path=t[t.length-1]),r(e)}function r(e,t){if(e){var i,n,s=e.path||M(Pe.slice(2===Pe.type?4:0))+e.name,a=Ve[e.type],o={action:"play",mime:e.mime,data:{title:e.name,uri:s,solution:e.solution||"auto"},events:{end:function(){var t=Ve[e.type];return i=t.next,i=void 0==i?t.next=t.indexOf(e)+1:t.next=i+1,i===t.length?(n.close(),Z.focusIndex(_e.length+i+1),void(t.next=null)):void r(t[i],{context:Q})},prev:function(){var t=Ve[e.type];return i=t.next,0===i||!i&&1===t.length?(n.close(),Z.focusIndex(_e.length),void(t.next=null)):(i=void 0==i?t.next=t.indexOf(e)-1:t.next=i-1,void r(t[i],{context:Q}))},next:function(){var t=Ve[e.type];return i=t.next,i===t.length-1||!i&&1===t.length?(n.close(),Z.focusIndex(_e.length+i+1),void(t.next=null)):(i=void 0==i?t.next=t.indexOf(e)+1:t.next=i+1,void r(t[i],{context:Q}))},close:function(){Z.focusIndex(i?_e.length+i+1:Z.$focusItem.index)},error:function(e){}}};t&&Object.keys(t).forEach(function(e){o[e]=t[e]}),a.indexOf(e)||delete o.events.prev,a.indexOf(e)===a.length-1&&delete o.events.next,n=core.intent(o,function(e,t){Q=t})}}function c(e){}function d(e){if(e){var t,i,n=e.path||M(Pe.slice(2===Pe.type?4:0))+e.name,s=Ve[e.type],a={action:"play",mime:e.mime,data:{title:e.name,uri:n},events:{end:function(){var n=Ve[e.type];return t=n.next,t=void 0==t?n.next=n.indexOf(e)+1:n.next=t+1,t===n.length?(i.close(),Z.focusIndex(_e.length+t+1),void(n.next=null)):void r(n[t],{context:Q})},prev:function(){var n=Ve[e.type];return t=n.next,0===t||!t&&1===n.length?(i.close(),Z.focusIndex(_e.length),void(n.next=null)):(t=void 0==t?n.next=n.indexOf(e)-1:n.next=t-1,void r(n[t],{context:Q}))},next:function(){var n=Ve[e.type];return t=n.next,t===n.length-1||!t&&1===n.length?(i.close(),Z.focusIndex(_e.length+t+1),void(n.next=null)):(t=void 0==t?n.next=n.indexOf(e)+1:n.next=t+1,void r(n[t],{context:Q}))},close:function(){Z.focusIndex(t?_e.length+t+1:Z.$focusItem.index)},error:function(e){}}};s.indexOf(e)||delete a.events.prev,s.indexOf(e)===s.length-1&&delete a.events.next,i=core.intent(a,function(e,t){Q=t})}}function u(e){var t=null,i=null,n={files:[]};return e.split("\n").forEach(function(e){e=e.trim();var s=e.split(" "),a=s.shift().toLowerCase(),o=e.slice(a.length).trim();switch(a){case"title":case"performer":case"songwriter":'"'===o.charAt(0)&&'"'===o.charAt(o.length-1)&&(o=o.slice(1,o.length-1)),null!==i?i[a]=o:n[a]=o;break;case"file":t={tracks:[]};var l=o.split(" ");l.length>1&&'"'!==o.charAt(o.length-1)&&(t.type=l.pop(),o=o.slice(0,-t.type.length).trim()),'"'===o.charAt(0)&&'"'===o.charAt(o.length-1)&&(o=o.slice(1,o.length-1)),t.name=o,n.files.push(t);break;case"track":i={number:s[0],type:s[1],index:[]},t.tracks.push(i);break;case"rem":if(-1!==["GENRE","DATE","COMMENT","PLACE"].indexOf(s[0])){o=o.slice(s[0].length).trim();var r=s[0].toLowerCase();'"'===o.charAt(0)&&'"'===o.charAt(o.length-1)&&(o=o.slice(1,o.length-1)),null!==i?i[r]=o:n[r]=o}break;case"index":if(null!==i){var c=(s[1]||"00:00:00").split(":");i.index.push(60*parseInt(c[0],10)+parseInt(c[1],10))}}}),n}function h(e){var t=e.trim().split("\n"),i={},n={strict:!1,config:{},items:[]};return t=t.map(Function.prototype.call,String.prototype.trim),t=t.filter(Boolean),t.length>0&&("#EXTM3U"===t[0]&&(n.strict=!0,t.shift()),t.forEach(function(e){var t,s,a,o;if("#"===e.charAt(0))switch(e.substr(1,6).toUpperCase()){case"EXTCFG":t=e.substr(7).trim(),s=t.indexOf("="),s>0&&(a=t.substr(0,s).trim(),o=t.substr(s+1).trim(),a&&o&&(a=a.split("."),1===a.length?n.config[a[0]]=o:("object"!=typeof n.config[a[0]]&&(n.config[a[0]]={}),n.config[a[0]][a[1]]=o)));break;case"EXTINF":t=e.substr(8).trim(),s=t.indexOf(","),s>0&&(i.time=t.substr(0,s).trim(),i.name=t.substr(s+1).trim())}else i.uri=e,-1===e.indexOf("://")?(e=e.replace(/\\/g,"/"),i.ext=e.split(".").pop().toLowerCase(),i.path=M(Pe.slice(2===Pe.type?4:0))+e):i.path=e,i.name=i.name||i.uri,n.items.push(i),i={}}),n.config&&["VM_IPTV_ENABLED","VM_OTT_ENABLED","VM_OTT_LOG_ENABLED"].forEach(function(e){n.config[e]&&(n.config[e]=-1!==["true","yes","1"].indexOf(n.config[e].toLowerCase()))})),n}function p(){var e=Be.sharesStorage;e.forEach(function(e){je.push(e.server)})}function f(e,t,i){var n="undefined"!=typeof i.index?i.index:0;"getGroups"===e?ce.network.getGroups(function(e,t){ae=t,w(Z,y(t,2,i),7,7,te,{focusIndex:n})}):"openShare"===e?(f.openShareAttempts+=1,Ae.umount({path:le,force:!0}),s(t,function(e,i){i||1!==f.openShareAttempts?!i&&f.openShareAttempts>1?De({title:gettext("Credentials are incorrect"),icon:"alert",type:"warning"}):(_(),f.openShareAttempts=0,5!==Pe.currentDeviceType&&Pe.push({index:Z.$focusItem.index,path:t,type:2.3}),Ae.readDir(t.mountPath,function(e,i){Pe.push({index:Z.$focusItem.index,path:t.mountPath}),Pe.isDisplayShares=!0,ae=null,Pe.currentDirFilesCount=i.dirs.length+i.files.length,w(Z,y(i,1),7,7,te,{focusIndex:n}),S("1000000",[Pe.currentDirFilesCount+"",null,null,null,null,null,null])})):De({title:gettext("Authorization may be necessary. Specify login and password?"),icon:"info",type:"",buttons:[{value:gettext("Cancel"),click:function(){f.openShareAttempts=0}},{value:gettext("Ok"),click:function(){Y.blur(),Ne.modalMessageSambaAuthorize.show(),Ne.modalMessageSambaAuthorize.focus()}}]})})):ce.network[e](t,function(t,s){"getShares"===e&&(j=s,s&&~je.indexOf(s[0].server)&&(i.favSharesPresent=!0,i.idx=je.indexOf(s[0].server))),ae=s,w(Z,y(s,2,i),7,7,te,{focusIndex:n})})}function m(){var e=Pe.last;Pe=[],Pe.last=e,Pe.type=0,H=null}function v(e){Ve={},e.forEach(function(e){Ve[e.type]?Ve[e.type].push(e):Ve[e.type]=[e]})}function g(){var e,t;if((7!==Pe.type&&!Pe.isDisplayFavorites||Pe.isDisplayFavorites&&Pe.length>1)&&(t=Pe.last().index,Pe.pop(),e=Pe.length),Pe.isDisplayFavorites&&!Pe.length)w(Z,D(),7,7,te,{focusIndex:Pe.entryPointIndex}),S("0000000",[null,null,null,null,null,null,null]),m(),Ne.footer.init([{type:"f1",title:gettext("Clear"),action:Ue[Me.ACTION_CLEAR_FAV]}]),Ne.footer.show(),$(),R.innerText=gettext("files");else if(2===Pe.type&&4===e)H=null,f("getShares",Pe[Pe.length-2].path,{icon:"V",index:t}),S("0000000",[null,null,null,null,null,null,null]),Pe.pop(),R.innerText=gettext("SAMBA");else if(2===Pe.type&&e>4)5===Pe.length&&(R.innerText=Pe[3].path.folder),
Ae.readDir(M(Pe.slice(4)),function(e,i){Pe.currentDirFilesCount=i.dirs.length+i.files.length,w(Z,y(i,1),7,7,te,{focusIndex:t}),S("1000000",[Pe.currentDirFilesCount+"",null,null,null,null,null,null])}),B.innerText=J.title.length?J.title.join(", "):gettext("All"),O(J.types);else if(1===Pe.type)if(Pe.isDisplayFavorites&&1===Pe.length){var i=Be.favoritesStorage;Pe.currentDirFilesCount=Be.favoritesStorage.length,Pe.pop(),w(Z,y({dirs:i.filter(function(e){return 9===e.type}),files:i.filter(function(e){return e.type>9})},1),7,7,te,{focusIndex:0})}else Ae.readDir(M(),function(i,n){var s,a="0",o=Pe.currentDevice;Pe.currentDirFilesCount=n.dirs.length+n.files.length,e?(s=y(n,1),R.innerText=1===Pe.length?Pe.isDisplayShares?o.name:o.label||o.vendor||o.model:Pe.last().path,B.innerText=J.title.length?J.title.join(", "):gettext("All"),O(J.types)):(m(),R.innerText=gettext("files"),s=D(),Ne.footer.hide(),a=5===Pe.currentDeviceType?Pe.currentDevice.address:null),B.innerText=gettext("All"),5===Pe.currentDeviceType?S("0100000",[null,a,null,null,null,null,null]):Pe.currentDevice&&S(+!!e+"000"+ +!e+ +!e+"0",[e?Pe.currentDirFilesCount+"":null,null,null,null,e?null:be(Pe.currentDevice.size,Pe.currentDevice.freeSize).overview,e?null:se[Pe.currentDevice.fsType],null]),Pe.currentDeviceType=null,w(Z,s,7,7,te,{focusIndex:t})});else 2===Pe.type&&4>e?(Ne.footer.hide(),3===Pe.length?(f("getShares",Pe[Pe.length-1].path,{icon:"V",index:t}),Pe.isDisplayShares=!1,R.innerText=gettext("SAMBA")):2===Pe.length?(H=null,f("getServers",Pe[Pe.length-1].path,{icon:"U",index:t}),R.innerText=gettext("servers")):1===Pe.length?(f("getGroups",null,{icon:"T",index:t}),R.innerText=gettext("work groups")):(Te.querySelector(".panelEx.main").classList.remove("networkView"),Pe.type=0,H=null,ae=null,w(Z,D(),7,7,te,{focusIndex:Pe.entryPointIndex}),Ne.footer.hide(),R.innerText=gettext("files"))):7===Pe.type&&(7.1===Pe.stageType?(w(Z,D(),7,7,te,{focusIndex:Pe.entryPointIndex}),m(),R.innerText=gettext("files")):7.2===Pe.stageType?(t=Pe.last().index,Le.openRoot(null,null,function(e,i){e?De({title:gettext(e.message),icon:"alert",type:"warning"}):(Pe.stageType=7.1,w(Z,y(i,7,null),7,7,te,{focusIndex:t}),Pe.pop())})):7.3===Pe.stageType&&(t=Pe.last().index,2===Pe.length?(Le.openServer(Pe[0].url,function(e,i){Pe.stageType=7.2,w(Z,y(i,7,null),7,7,te,{focusIndex:t})}),Pe.pop()):(Le.openContext(Pe.last().parentID,function(e,i){w(Z,y(i,7,null),7,7,te,{focusIndex:t})}),Pe.pop())))}function y(e,t,i){var s,a,o,l;if(oe=[{items:[{value:"S",className:"icon iconFileManager"},".."],click:function(){g()}}],1===t)s=e.dirs,a=e.files,a=a.map(function(e){var t;if(e.path&&~e.path.indexOf("://")?(e.ext="",e.subtype=re.playlistStream):void 0===e.size?(e.ext=e.ext||e.path.split(".").pop().toLowerCase(),e.subtype=re.playlistFile):e.ext=e.ext||e.name.split(".").pop().toLowerCase(),!e.type)for(t in He)if(~He[t].ext.indexOf(e.ext)){e.type=t;break}return e.mime=ee[e.type],e}),v(a),s=s.map(function(e){for(var t="icon iconFileManager favoritesStar theme-favorite-icon",i="B",s=Be.favoritesStorage.length,a=0,o=!1;s>a;a+=1)if(Be.favoritesStorage[a].path===(e.path||M()+e.name)){i="A",t+=" theme-favorite-icon-active",o=!0;break}return{items:[{value:"R",className:"icon iconFileManager"},{value:e.name,className:"listDirNameField"},!Pe.isDisplayShares&&{value:i,className:t}||{value:"",className:"icon iconFileManager"}],value:{name:e.name,type:9,item:e},click:function(){function t(){Ae.readDir(M(i),function(e,t){Pe.currentDirFilesCount=t.dirs.length+t.files.length,w(Z,y(t,1),7,7,te,{focusIndex:0}),S("1000000",[Pe.currentDirFilesCount+"",null,null,null,null,null,null]),O(J.types)})}var i;Pe.push({index:Z.$focusItem.index,path:Pe.isDisplayFavorites&&0===Pe.length?e.path:e.name}),i=2===Pe.type?Pe.slice(4):Pe,~["VIDEO_TS","BDMV","video_ts","bdmv","video_ts.ifo","VIDEO_TS.IFO"].indexOf(e.name)?De({title:gettext("Do you want to play folder's content?"),icon:"info",type:"",buttons:[{value:gettext("Cancel"),click:function(){t()}},{value:gettext("Play"),click:function(){n(e,{type:"dvd"})}}]}):t(),R.innerText=e.name,B.innerText=J.title.length?J.title.join(", "):gettext("All")}}}),a=a.map(function(e){var t,i,n="icon iconFileManager favoritesStar",s="B",a=Be.favoritesStorage.length,o=0,l=!1;for(i=1===Pe.type&&!Pe.isDisplayShares||e.subtype===re.playlistStream&&2!==Pe.type,0===a&&(n+=" theme-favorite-icon");a>o;o+=1){if(Be.favoritesStorage[o].path===(e.path||M()+e.name)){s="A",n+=" theme-favorite-icon-active",l=!0;break}o+1===a&&(n+=" theme-favorite-icon")}for(o in He)if(~He[o].ext.indexOf(e.ext)){t=He[o].ico;break}return{items:[{value:t,className:"icon iconFileManager"+(1===Pe.type?" listDirFileIcon":"")},{value:e.name,className:"listDirNameField"},i&&{value:s,className:n}||{value:"",className:"icon iconFileManager"}],value:{name:e.name,type:10,item:e,isFavorite:l},click:function(){ze[e.type]?ze[e.type](e):De({title:gettext("Can not open this kind of file"),icon:"info"})}}});else{if(2===t)return e=(e||[]).map(function(e){var t,n,s="",a=e.name,o=Be.sharesStorage;if(i&&i.favSharesPresent)for(t=o.slice(i.idx),n=t.length;n--;)if(t[n].name===a){s="theme-favorite-icon-active";break}return{items:[{value:i&&i.icon||"O",className:"icon iconFileManager "+s},e.name],click:function(){1===Pe.length?(Pe.push({index:Z.$focusItem.index,path:{group:e.name,uri:e.uri},type:2.1}),f("getServers",Pe.last().path,{icon:"U"}),R.innerText=gettext("servers")):2===Pe.length?(Pe.push({index:Z.$focusItem.index,path:e.name,type:2.2}),f("getShares",Pe.last().path,{icon:"V"}),R.innerText=gettext("SAMBA")):3===Pe.length&&(f("openShare",{address:e.address,folder:e.name,mountPath:le,login:e.login,password:e.password},{}),R.innerText=e.name,B.innerText=J.title.length?J.title.join(", "):gettext("All"))},value:{item:e}}}),oe.concat(e);if(7===t){if(7.1===Pe.stageType)return o=e.map(function(e){return{items:[{value:"V",className:"icon iconFileManager"},e.name],click:function(){Pe.push({index:Z.$focusItem.index,url:e.url,ID:e.ID,parentID:e.parentID}),Le.openServer(e.url,function(e,t){Pe.stageType=7.2,w(Z,y(t,7,null),7,7,te,{focusIndex:0})})},value:e}}),oe.concat(o);if(7.2===Pe.stageType||7.3===Pe.stageType)return l=function(e){return{items:[{value:9===e.type?"R":He[e.type].ico,className:"icon iconFileManager"},{value:e.name,className:"listDirNameField"},{value:"",className:"icon iconFileManager"}],value:{name:e.name,type:9===e.type?9:10,item:e},click:function(){9===e.type?(Pe.push({index:Z.$focusItem.index,ID:e.ID,parentID:e.ParentID}),Le.openContext(e.ID,function(e,t){Pe.stageType=7.3,w(Z,y(t,7,null),7,7,te,{focusIndex:0})})):ze[e.type]?ze[e.type](e):De({title:gettext("Can not open this kind of file"),icon:"info"})}}},o=x(e),a=o.filter(function(e){return 9!==e.type}).map(function(e){return e.mime=ee[e.type],e}),v(a),o=o.map(l),oe.concat(o);7.3===Pe.stageType}}return _e=s,Re=a,H=s.concat(a).sort(function(e,t){return e.value.name.toLowerCase().localeCompare(t.value.name.toLowerCase())}),U=(H=oe.concat(H)).slice()}function x(e){for(var t,i=[];t=e.shift();){switch(t.ContentType){case Le.TYPE_FOLDER:t.type=9,t.url=t.ID;break;case Le.TYPE_AUDIO:t.type=6;break;case Le.TYPE_VIDEO:t.type=5;break;case Le.TYPE_IMAGE:t.type=7;break;default:t.type=8}t.type!==Le.TYPE_FOLDER&&t.Resources&&t.Resources.length&&(t.path=t.Resources[0].Value,t.size=t.Resources[0].Size),t.Resources=null,t.readOnly=!0,t.name=t.Title,i.push(t)}return i}function w(e,t,i,n,s,a){var o={scroll:t.length<=n?null:s,size:i,data:t};a&&Object.keys(a).forEach(function(e){o[e]=a[e]}),s&&(t.length>n?e.scroller||(e.scroller=1,s.init({realSize:t.length}),s.$node.style.display=""):(e.scroller=0,s.$node.style.display="none")),e.setData(o)}function b(e){var t=[[ke.tag("div",{className:"title"},gettext("Display name")+":"),ke.tag("div",{},e.details.name)],[ke.tag("div",{className:"title"},gettext("Real name")+":"),ke.tag("div",{},e.details.address.slice(e.details.address.lastIndexOf("/")+1))],[ke.tag("div",{className:"title"},gettext("Type")+":"),ke.tag("div",{},gettext("SAMBA"))],[ke.tag("div",{className:"title"},gettext("Server")+":"),ke.tag("div",{},e.details.server)],[ke.tag("div",{className:"title"},gettext("Full path")+":"),ke.tag("div",{},e.details.address)]];try{Te.getElementsByClassName("infoStorageDiagram")[0].classList.add("hidden"),Te.getElementsByClassName("cntIndicators")[0].classList.add("hidden")}catch(i){}Ne.textArea.$body.innerHTML="",Ne.textArea.$body.appendChild(ke.fragment.apply(null,[].concat.apply([],t))),Ne.textArea.show(),Ne.textArea.init()}function $(){var e=Be.favoritesStorage;try{Te.getElementsByClassName("infoStorageDiagram")[0].classList.add("hidden"),Te.getElementsByClassName("cntIndicators")[0].classList.add("hidden")}catch(t){}Ne.textArea.$body.innerHTML="",Ne.textArea.$body.appendChild(ke.fragment(ke.tag("div",{className:"title"},gettext("Total")+":"),ke.tag("div",{},String(e.length))))}function I(e){var t=e.path||M(Pe.slice(2===Pe.type?4:0))+e.name;Ae.readFile(t,function(t,i){var n=u(i),s=[[ke.tag("div",{className:"title"},gettext("Name")+":"),ke.tag("div",{},e.name)],[ke.tag("div",{className:"title"},gettext("Creation date")+":"),ke.tag("div",{},new Date(e.last_modified).toLocaleDateString())],[ke.tag("div",{className:"title"},gettext("Size")+":"),ke.tag("div",{},be(e.size).singleObject)],[ke.tag("div",{className:"title"},gettext("Album name")+":"),ke.tag("div",{},n.title)],[ke.tag("div",{className:"title"},gettext("Performer")+":"),ke.tag("div",{},n.performer)],[ke.tag("div",{className:"title"},gettext("Genre")+":"),ke.tag("div",{},n.genre)],[ke.tag("div",{className:"title"},gettext("Comment")+":"),ke.tag("div",{},n.comment)],[ke.tag("div",{className:"title"},gettext("Source")+":"),ke.tag("div",{},n.files[0]?n.files[0].name:"")]];Ne.textArea.$body.innerHTML="",Ne.textArea.$body.appendChild(ke.fragment.apply(null,[].concat.apply([],s))),Ne.textArea.show(),Ne.textArea.init()})}function S(e,t){var i,n=Ne.textArea,s=e.split(""),a=Te.getElementsByClassName("infoStorageDiagram")[0],o=Te.getElementsByClassName("cntIndicators")[0];ke.tag("div",{});i=[[ke.tag("div",{className:"title"},gettext("Elements")+":")],[ke.tag("div",{className:"title"},gettext("Name")+":")],[ke.tag("div",{className:"title"},gettext("Creation date")+":")],[ke.tag("div",{className:"title"},gettext("Size")+":")],[ke.tag("div",{className:"title"},gettext("Free space")+":")],[ke.tag("div",{className:"title"},gettext("File system")+":")],[ke.tag("div",{className:"title"},gettext("Unsaved changes")+":")],[ke.tag("div",{className:"title"},gettext("Address")+":")]],a&&a.classList[+s[4]?"remove":"add"]("hidden"),o&&o.classList[+s[4]?"remove":"add"]("hidden"),n.$body.innerHTML="",n.$body.appendChild(ke.fragment.apply(null,[].concat.apply([],i.reduce(function(e,i,n){return+s[n]&&(i.push(ke.tag("div",{},t[n])),e.push(i)),e},[])))),Ne.textArea.show(),Ne.textArea.init()}function k(e){var t=[{items:[{value:"",className:"icon f3"},gettext("Add to favorites")],click:function(){C(),Ne.modalMessageActions.hide()}},{items:[{value:"F",className:"icon iconFileManager"},gettext("Open")],click:function(){var e=Z.$focusItem;9===e.value.type?(Pe.push({index:Z.$focusItem.index,path:e.value.name}),Ae.readDir(M(),function(e,t){Pe.currentDirFilesCount=t.dirs.length+t.files.length,w(Z,y(t,1),7,7,te,{focusIndex:0}),S("1000100",[Pe.currentDirFilesCount+"",null,null,null,be(Pe.currentDevice.size,Pe.currentDevice.freeSize).overview,null,null])})):ze[e.value.item.type](e.value.item),Ne.modalMessageActions.hide()}},{items:[{value:"",className:"icon f2"},gettext("Create folder")],click:function(){Ne.modalMessageActions.hide(),Y.hide(),Ne.modalMessageCreateFolder.show(),Ne.modalMessageCreateFolder.focus()}},{items:[{value:"",className:"icon f1"},gettext("Delete")],click:function(){De({title:gettext("Are you sure you want to delete this object?"),icon:"info",type:"",buttons:[{value:gettext("Cancel"),click:function(){}},{value:gettext("Ok"),click:function(){F()}}]})}},{items:[{value:"W",className:"icon iconFileManager"},gettext("Create shortcut")],click:function(){N(),Ne.modalMessageActions.hide()}},{items:[{value:"",className:"icon f1"},gettext("Delete")],click:function(){De({title:gettext("Are you sure you want to delete this share?"),icon:"info",type:"",buttons:[{value:gettext("Cancel"),click:function(){}},{value:gettext("Ok"),click:function(){T(),Ne.modalMessageActions.hide(),Ne.footer.show()}}]})}},{items:[{value:"",className:"icon f4"},gettext("Rename")],click:function(){Ne.modalMessageActions.hide(),Y.hide(),Ne.modalMessageRenameShare.show(),Ne.modalMessageRenameShare.focus()}},{items:[{value:"",className:"icon f1"},gettext("Clear")],click:function(){Ue[Me.ACTION_CLEAR_FAV]()}}];return t.filter(function(t,i){return+e[i]})}function C(){var e=Z.$focusItem,t=H[e.index],i={},n=e.index;t.value.isFavorite?(Be.favoritesStorage=Be.favoritesStorage.filter(function(e){return e.path!==M()+t.value.name&&e.path!==t.value.item.path}),t.items[2].value="B",t.items[2].className="icon iconFileManager favoritesStar theme-favorite-icon",t.value.isFavorite=!1):(i.type=t.value.type,i.name=t.value.name,t.value.item.subtype===re.playlistStream?i.path=t.value.item.uri:t.value.item.subtype===re.playlistFile?(i.path=t.value.item.path,i.uri=t.value.item.uri):(i.path=M()+t.value.name,i.size=t.value.item.size,i.last_modified=t.value.item.last_modified),Be.favoritesStorage.push(i),t.items[2].value="A",t.items[2].className+=" theme-favorite-icon-active",t.value.isFavorite=!0),w(Z,H.slice(0,n).concat(t,H.slice(n+1)),7,7,te,{viewIndex:Z.viewIndex}),Z.focusIndex(n)}function N(){var e=Z.$focusItem;e.children[0].children[0].classList.add("theme-favorite-icon-active"),Be.sharesStorage.push(e.data.value.item)}function T(){var e=Z.$focusItem,t=e.data.value.details,i=e.index;Be.sharesStorage=Be.sharesStorage.filter(function(e){return e.address!==t.address}),w(Z,D(),7,7,te,{focusIndex:D.itemsLength===i?i-1:i})}function E(e){for(var t=Z.$focusItem,i=t.data.value.details,n=t.index,s=Be.sharesStorage.length;s--;)if(Be.sharesStorage[s].address===i.address){Be.sharesStorage[s].name=e;break}w(Z,D(),7,7,te,{focusIndex:n})}function D(){var e,t,i,n=[],s=Be.sharesStorage,a=0;return window.stbUPnP&&window.stbUPnP.getServerListSync?a=1:core.environment.upnp_conf&&"off"!==core.environment.upnp_conf&&(e="/media/UPnP",a=1),i=[{items:[{value:"A",className:"icon iconFileManager"},{value:gettext("favorites"),className:"persistentMainEntries"}],value:{type:1},click:function(){var e=Be.favoritesStorage;e=e.map(function(e){var t,i={};for(t in e)i[t]=e[t];return i}),Pe.type=1,Pe.isDisplayFavorites=!0,Pe.entryPointIndex=Z.$focusItem.index,Pe.currentDirFilesCount=Be.favoritesStorage.length,R.innerText=gettext("favorites"),w(Z,y({dirs:e.filter(function(e){return 9===e.type}),files:e.filter(function(e){return e.type>9&&!(e.type=void 0)})},1),7,7,te,{focusIndex:0})}},{items:[{value:"O",className:"icon iconFileManager"},{value:gettext("network"),className:"persistentMainEntries"}],value:{type:2},click:function(){Te.querySelector(".panelEx.main").classList.add("networkView"),Pe.type=2,Pe.entryPointIndex=Z.$focusItem.index,Pe.length=0,Pe.push({index:Z.$focusItem.index,path:"SAMBA_GROUP"}),Pe.type=2,f("getGroups",null,{icon:"T"}),R.innerText=gettext("work groups")}},{items:[{value:"P",className:"icon iconFileManager"},"UPnP"],value:{type:7},click:function(){R.innerText=gettext("UPnP"),Pe.currentDevice=null,Pe.entryPointIndex=Z.$focusItem.index,Pe.currentDeviceType=7,Pe.stageType=7,e?(Pe.type=1,Pe.push({index:Z.$focusItem.index,path:e}),Ae.readDir(M(),function(e,t){Pe.currentDirFilesCount=t.dirs.length+t.files.length,w(Z,y(t,1),7,7,te,{focusIndex:0})})):(Pe.type=7,Le.openRoot(null,null,function(e,t){e?De({title:gettext(e.message),icon:"alert",type:"warning"}):(Pe.stageType=7.1,w(Z,y(t,7,null),7,7,te,{focusIndex:0}))})),Ne.footer.init([{type:"f4",title:gettext("Search"),action:Ue[Me.ACTION_SEARCH]}]),Ne.footer.show()}}],!a&&i.pop(),Fe.forEach(function(e){n.push({items:[{value:"N",className:"icon iconFileManager"},e.label||e.vendor||e.model],value:{sizeOverview:be(e.size,e.freeSize).overview,freeSize:e.freeSize,fullSize:e.size,fsType:se[e.fsType],deviceType:8},click:function(){R.innerText=e.label||e.vendor||e.model,Pe.type=1,Pe.currentDevice=e,Pe.entryPointIndex=Z.$focusItem.index,Pe.currentDeviceType=8,Pe.stageType=8,Pe.push({index:Z.$focusItem.index,path:e.mountPath}),Ae.readDir(M(),function(t,i){Pe.currentDirFilesCount=i.dirs.length+i.files.length,S("1000100",[Pe.currentDirFilesCount+"",null,null,null,be(e.size,e.freeSize).overview,null,null]),w(Z,y(i,1),7,7,te,{focusIndex:0}),Ne.footer.init([{type:"f2",title:gettext("Create folder"),action:function(){}},{type:"f4",title:gettext("Search"),action:function(){}}]),Ne.footer.show()})}})}),s.forEach(function(e){n.push({items:[{value:"V",className:"icon iconFileManager"},e.name],value:{details:e,deviceType:5},click:function(){Pe.isDisplayShares=!0,Pe.type=1,Pe.currentDevice=e,Pe.currentDeviceType=5,Pe.entryPointIndex=Z.$focusItem.index,Ne.footer.hide(),f("openShare",{address:e.address,folder:e.name,mountPath:le,login:e.login,password:e.password},{}),R.innerText=e.name}})}),t=i.concat(n),D.itemsLength=t.length,t}function M(e){return(e||Pe).reduce(function(e,t){return e+t.path+"/"},"")}function A(e){var t,i=[H[0]],n=H.slice(1),s=_e.slice();switch(t=n.filter(function(e){return 10===e.value.type}),e){case"NAME":s.sort(function(e,t){return e.value.name.toLowerCase().localeCompare(t.value.name.toLowerCase())}),t.sort(function(e,t){return e.value.name.toLowerCase().localeCompare(t.value.name.toLowerCase())}),w(Z,i.concat(s,t),7,7,te,{focusIndex:0});break;case"DATE":t.sort(function(e,t){return e.value.item.last_modified-t.value.item.last_modified}),w(Z,i.concat(_e,t),7,7,te,{focusIndex:0});break;case"TYPE":t.sort(function(e,t){return e.value.item.ext.toLowerCase().localeCompare(t.value.item.ext.toLowerCase())}),w(Z,i.concat(_e,t),7,7,te,{focusIndex:0});break;case"SIZE":t.sort(function(e,t){return e.value.item.size-t.value.item.size}),w(Z,i.concat(_e,t),7,7,te,{focusIndex:0})}}function L(){var e,t,i,n;if(n=new RegExp(V,"i"),ae)e=ae.filter(function(e){return n.test(e.name)}),w(Z,y(e,2,{icon:"U"}),7,7,te,{focusIndex:0});else{if(!V)return H=U.slice(),w(Z,H,7,7,te,{focusIndex:0}),Pe.currentDirFilesCount=H.length-1,void S("1000000",[Pe.currentDirFilesCount+"",null,null,null,null,null,null]);i=[H[0]],e=U.slice(1).filter(function(e){return n.test(e.value.name)}),t=e.map(function(e){return e.value.item}),H=i.concat(e),w(Z,H,7,7,te,{focusIndex:0}),Pe.currentDirFilesCount=e.length,S("1000000",[Pe.currentDirFilesCount+"",null,null,null,null,null,null]),v(t)}}function O(e){if(H){var t,i,n=[U[0]],s=U.slice(1);e.length?(i=s.filter(function(t){return~e.indexOf(+t.value.type)||~e.indexOf(+t.value.item.type)}),t=i.map(function(e){return e.value.item}),H=n.concat(i),w(Z,H,7,7,te,{focusIndex:0}),v(t),Pe.currentDirFilesCount=i.length,S("1000000",[Pe.currentDirFilesCount+"",null,null,null,null,null,null])):L()}}function F(){var e=Z.$focusItem,t=H.length,i=e.index;Ae[9===e.value.type?"removeDir":"removeFile"](M()+Z.$focusItem.value.name,function(e,n){w(Z,(H.splice(i,1),H),7,7,te,{focusIndex:t-1===i?i-1:i}),Ne.modalMessageActions.hide()}),Pe.currentDirFilesCount-=1}function P(e){function t(e){return new pe({cycle:!0,size:e.length,focusIndex:0,data:e.map(function(e){return{items:[e]}}),events:{overflow:function(e){e.direction!==de.down&&e.direction!==de.up||(this.blurItem(this.$focusItem),N.focus())}}})}var i,n,a,o,l,r,c,d,u,h,p,g,x,N,P,j,U,Q,ee,se,ae,oe,ce,we,ke,Ce;document;Ue[Me.ACTION_RESET_FILTERS]=function(){De({title:gettext("Do you really want to reset all of the applied filters?"),icon:"info",type:"",buttons:[{value:gettext("Cancel"),click:function(){}},{value:gettext("Ok"),click:function(){o.setValue(""),x=x.map(function(e){return e.state=!1,e}),J.setData({data:x}),O([]),B.innerText=gettext("All"),J.types=[],J.title=[]}}]})},Ue[Me.ACTION_DELETE_FS]=function(){},Ue[Me.ACTION_DELETE_SMB]=function(){},Ue[Me.ACTION_CREATE_FOLDER]=function(){},Ue[Me.ACTION_MANUAL_ADD_SHARE]=function(){},Ue[Me.ACTION_TOGGLE_FAV]=function(){},Ue[Me.ACTION_CLEAR_FAV]=function(){De({title:gettext("Are you sure you want to clear the list of favorites?"),icon:"info",type:"",buttons:[{value:gettext("Cancel"),click:function(){}},{value:gettext("Ok"),click:function(){Be.favoritesStorage=[]}}]})},Ue[Me.ACTION_RENAME_SMB]=function(){Ne.modalMessageActions.hide(),Y.hide(),Ne.modalMessageRenameShare.show(),Ne.modalMessageRenameShare.focus()},Ue[Me.ACTION_SEARCH]=function(){G.focus(),o.focus()},x=[{state:!1,title:gettext("Folders"),value:9},{state:!1,title:gettext("Video"),value:5},{state:!1,title:gettext("Audio"),value:6},{state:!1,title:gettext("Text"),value:8},{state:!1,title:gettext("Disk images"),value:9},{state:!1,title:gettext("Records"),value:12},{state:!1,title:gettext("Playlists"),value:14},{state:!1,title:gettext("Streams"),value:15}],Ne.footer=new Ie({parent:Ne,data:[]}),te=new $e({value:0,viewSize:7,className:"listScroll"}),ne=new $e({value:0,viewSize:5,className:"filterScroll"}),ie=new $e({className:"rightInfoPanelScroll"}),Ne.textArea=new xe({propagate:!0,scroll:ie}),P=new ye({value:gettext("create"),className:"createBtn bottom"}),j=new ye({value:gettext("Rename"),className:"createBtn bottom"}),N=new ye({value:gettext("mount"),className:"createBtn bottom table"}),Q=new ye({value:gettext("authorize"),className:"authorizeBtn bottom"}),l=new ge({placeholder:gettext("Server address"),className:"themeBg",events:{keydown:function(e){Ne.modalMessageMountShare.onKeyDown.call(this,e)}}}),r=new ge({placeholder:gettext("Server folder"),className:"themeBg",events:{keydown:function(e){Ne.modalMessageMountShare.onKeyDown.call(this,e),e.code===de.ok&&(c.value||c.setValue(this.value))}}}),c=new ge({placeholder:gettext("Local folder"),className:"themeBg",events:{keydown:function(e){Ne.modalMessageMountShare.onKeyDown.call(this,e),e.code===de.ok&&!this.value&&r.value&&this.setValue(r.value)}}}),d=new ge({placeholder:gettext("Server address"),className:"themeBg",events:{keydown:function(e){Ne.modalMessageMountShare.onKeyDown.call(this,e)}}}),u=new ge({placeholder:gettext("Server folder"),className:"themeBg",events:{keydown:function(e){Ne.modalMessageMountShare.onKeyDown.call(this,e),e.code===de.ok&&(h.value||h.setValue(this.value))}}}),h=new ge({placeholder:gettext("Local folder"),className:"themeBg",events:{keydown:function(e){Ne.modalMessageMountShare.onKeyDown.call(this,e),e.code===de.ok&&!this.value&&u.value&&this.setValue(u.value)}}}),p=new ge({placeholder:gettext("Login"),className:"themeBg",events:{keydown:function(e){Ne.modalMessageMountShare.onKeyDown.call(this,e)}}}),g=new ge({placeholder:gettext("Password"),className:"themeBg",events:{keydown:function(e){Ne.modalMessageMountShare.onKeyDown.call(this,e)}}}),we=[d,u,h,p,g],ce=[l,r,c],n=new ge({placeholder:gettext("New name"),className:"themeBg",events:{keydown:function(e){var t=!this.value;switch(ge.prototype.defaultEvents.keydown.call(this,e),e.code){case de.back:t&&(_(),Y.show()),e.stop=!0;break;case de.ok:j.emit("click");break;case de.down:n.blur(),j.focus()}}}}),a=new ge({value:gettext("New folder"),className:"themeBg",events:{keydown:function(e){var t=!this.value;switch(ge.prototype.defaultEvents.keydown.call(this,e),e.code){case de.back:t&&(_(),Y.show()),e.stop=!0;break;case de.ok:P.emit("click");break;case de.down:a.blur(),P.focus()}}}}),o=new ge({placeholder:gettext("Search"),events:{keydown:function(e){switch(ge.prototype.defaultEvents.keydown.call(this,e),e.code){case de.back:e.stop=!0;break;case de.ok:if(this.parent.emit("click"),""===this.value.trim()&&this.setValue(""),!Pe.type)return;V=this.value.trim(),L()}}}}),ee=new ge({placeholder:gettext("Login"),className:"themeBg",events:{keydown:function(e){var t=!this.value;switch(ge.prototype.defaultEvents.keydown.call(this,e),e.code){case de.back:t&&_(),e.stop=!0;break;case de.ok:this.parent.emit("click");break;case de.down:ee.blur(),se.focus()}}}}),se=new ge({placeholder:gettext("Password"),className:"themeBg",events:{keydown:function(e){var t=!this.value;switch(ge.prototype.defaultEvents.keydown.call(this,e),e.code){case de.back:t&&_(),e.stop=!0;break;case de.ok:this.parent.emit("click");break;case de.up:ee.focus();break;case de.down:Q.focus()}}}}),Ne.modalMessageSambaAuthorize=new fe({title:gettext("authorization"),events:{show:function(){ee.focus(),Ee=!0,Ne.footer.hide()},hide:function(){Ne.footer.show()}},children:[U=new pe({cycle:!0,size:2,focusIndex:0,data:[{items:[ee]},{items:[se]}],events:{overflow:function(e){e.direction===de.down&&(this.blurItem(this.$focusItem),Q.focus())}}}),Q]}),Ne.modalMessageSort=new fe({title:gettext("sorting"),events:{show:function(){Ne.modalMessageSort.children[0].focus(),Ee=!0}},children:[ae=new me({cycle:!0,focusIndex:0,size:4,events:{"click:item":function(e){var t=e.$item.value;A(1===t?"NAME":2===t?"DATE":3===t?"TYPE":"SIZE"),i.innerText=e.$item.data.title,Ne.modalMessageSort.hide(),Y.focus(),X.focus()}},data:[{state:!0,title:gettext("By name"),value:1},{state:!1,title:gettext("By date"),value:2},{state:!1,title:gettext("By type"),value:3},{state:!1,title:gettext("By size"),value:4}]})]}),Ne.modalMessageFilter=new fe({title:gettext("filtering"),events:{show:function(){Ne.modalMessageFilter.children[0].focus(),Ee=!0}},children:[J=new ve({cycle:!0,focusIndex:0,data:x,scroll:ne})]}),Ne.modalMessageActions=new fe({title:gettext("actions"),events:{show:function(){Ne.modalMessageActions.focus(),Y.blur(),Ee=!0},hide:function(){Y.focus(),Ee=!1}},children:[q=new pe({cycle:!0,focusIndex:0,size:0,data:[]})]}),Ne.modalMessageCreateFolder=new fe({title:gettext("Create folder"),events:{show:function(){a.focus(),Ee=!0,Ne.footer.hide()},hide:function(){Y.show(),Ne.footer.show()}},children:[a,P]}),Ne.modalMessageRenameShare=new fe({title:gettext("Rename"),events:{show:function(){n.focus(),Ee=!0,Ne.footer.hide()},hide:function(){Y.show(),Ne.footer.show()}},children:[n,j]}),Ne.modalMessageMountShare=new fe({title:gettext("Mount share"),events:{show:function(e){"NFS"===e.type?(Ne.modalMessageMountShare.children[0].hide(),Ne.modalMessageMountShare.children[1].show(),Ne.modalMessageMountShare.children[1].focus(),Ne.modalMessageMountShare.children[1].focusIndex(0),oe={address:l.setValue("")||l,folder:r.setValue("")||r,name:c.setValue("")||c}):(Ne.modalMessageMountShare.children[1].hide(),Ne.modalMessageMountShare.children[0].show(),Ne.modalMessageMountShare.children[0].focus(),Ne.modalMessageMountShare.children[0].focusIndex(0),oe={address:d.setValue("")||d,folder:u.setValue("")||u,name:h.setValue("")||h,login:p.setValue("")||p,password:g.setValue("")||g})},hide:function(){Y.show(),Ne.footer.show()}},children:[t(we),t(ce),N]}),ke=new ye({value:gettext("SMB"),className:"table textLeft",events:{click:function(){Ne.modalMessageShareType.hide(),Ne.modalMessageMountShare.focus(),Ne.modalMessageMountShare.show({type:"SMB"})},keydown:function(e){switch(ye.prototype.defaultEvents.keydown.call(this,e),e.code){case de.up:case de.down:this.blur(),Ce.focus()}}}}),Ce=new ye({value:gettext("NFS"),className:"table textLeft",events:{click:function(){Ne.modalMessageShareType.hide(),Ne.modalMessageMountShare.focus(),Ne.modalMessageMountShare.show({type:"NFS"})},keydown:function(e){switch(ye.prototype.defaultEvents.keydown.call(this,e),e.code){case de.up:case de.down:this.blur(),ke.focus()}}}}),Ne.modalMessageShareType=new fe({title:gettext("connection type"),events:{show:function(){Ne.modalMessageShareType.children[0].$checkedData=Ne.modalMessageShareType.children[0].data,Ne.modalMessageShareType.children[0].focus(),Ee=!0,Ne.footer.hide()}},children:[ke,Ce]}),Ne.modalMessageMountShare.onKeyDown=function(e){var t=!this.value;switch(ge.prototype.defaultEvents.keydown.call(this,e),e.code){case de.back:t&&_(),e.stop=!0;break;case de.ok:this.parent.emit("click")}},Ne.add(Ne.footer),Ne.add(Ne.modalMessageSort),Ne.add(Ne.modalMessageFilter),Ne.add(Ne.modalMessageActions),Ne.add(Ne.modalMessageShareType),Ne.add(Ne.modalMessageMountShare),Ne.add(Ne.modalMessageRenameShare),Ne.add(Ne.modalMessageCreateFolder),Ne.add(Ne.modalMessageSambaAuthorize),Ne.add(new Se),Ne.add(Y=new he({panels:[G=new ue({size:1,title:gettext("menu"),children:[X=new pe({cycle:!0,size:7,focusIndex:0,data:[{items:[{value:"J",className:"icon iconFileManager"},o]},{items:[{value:"I",className:"icon iconFileManager"},gettext("By name")],click:function(){Pe.type&&2!==Pe.type&&(Y.blur(),Ne.modalMessageSort.show(),Ne.modalMessageSort.focus())}},{items:[{value:"K",className:"icon iconFileManager"},gettext("All")],click:function(){var e,t;v(Re.map(function(e){return e.value.item})),Pe.type&&(e=Object.keys(Ve),t=x.filter(function(t){return~e.indexOf(String(t.value))}),_e.length&&t.unshift(x[0]),J.init({data:t,size:t.length<6?t.length:5,scroll:t.length<6?null:ne,focusIndex:0}),Y.blur(),Ne.modalMessageFilter.show(),Ne.modalMessageFilter.focus())}},{items:[{value:"O",className:"icon iconFileManager"},gettext("Mount share")],click:function(){Ne.modalMessageShareType.show(),Ne.modalMessageShareType.focus(),Y.blur()}}]})]}),K=new ue({size:1,title:gettext("files"),main:!0,children:!Ne.loaded&&[Z=new pe({cycle:!0,focusIndex:0,size:7,data:D(),scroll:te,noData:""})]}),W=new ue({size:1,title:gettext("details"),children:[]})]})),S("0000000",[null,null,null,null,null,null,null]),W.add(Ne.textArea,ie),i=X.$body.children[1].children[0].children[1],B=X.$body.children[2].children[0].children[1],K.$body.appendChild(te.$node),Ne.modalMessageFilter.$body.appendChild(ne.$node),D.itemsLength<=7&&(te.$node.style.display="none"),R=K.$title,J.title=J.title||[],J.types=J.types||[],Y.drawShadow(),K.focus(),$(),G.addListener("focus",function(){Ne.footer.init([{type:"f1",title:gettext("Reset filters"),action:Ue[Me.ACTION_RESET_FILTERS]}]),Ne.footer.show()}),W.addListener("focus",function(){Ne.footer.hide()}),K.addListener("focus",function(){var e=Z.$focusItem;(Pe.type||!Pe.type&&e.data.value&&(5===e.data.value.deviceType||1===e.data.value.type))&&(Ne.footer.show(),Z.emit("focus:item"))}),J.addListener("keydown",function(e){e.code===de.back&&(Array.prototype.forEach.call(J.$body.children,function(e){e.state&&(J.types.push(e.data.value),~J.title.indexOf(e.data.title)||J.title.push(e.data.title))}),x=x.map(function(e){return e.state=!!~J.types.indexOf(e.value),e}),O(J.types),B.innerText=J.title.length?J.title.join(", "):gettext("All"))}),Z.addListener("keydown",function(e){var t,i=Z.$focusItem;if(Pe.type)if(t=q.$body,1===Pe.type)if(e.code===de.menu){if(i.data.value){if(q.init({data:k("11110000"),size:4,focusIndex:0}),10===i.data.value.type)switch(t.children[0].classList.remove("hidden"),i.data.value.item.subtype){case re.playlistFile:q.init({data:k("01000000"),size:1,focusIndex:0});break;case re.playlistStream:q.init({data:k("11000000"),size:2,focusIndex:0});break;default:q.init({data:k("11110000"),size:4,focusIndex:0})}i.data.value.isFavorite&&(t.children[0].children[0].children[1].innerText=gettext("Remove from favorites")),Pe.isDisplayFavorites&&(t.children[0].children[0].children[1].innerText=gettext("Remove from favorites"),q.init({data:k("11000000"),size:2,focusIndex:0}))}else{if(Pe.isDisplayFavorites)return;q.init({data:k("00100000"),size:1,focusIndex:0})}Ne.modalMessageActions.show(),Ne.footer.hide()}else if(e.code===de.f1){if(Pe.isDisplayFavorites||!i.data.value||Pe.isDisplayShares)return;De({title:gettext("Are you sure you want to delete this object?"),icon:"info",type:"",buttons:[{value:gettext("Cancel"),click:function(){}},{value:gettext("Ok"),click:function(){F()}}]})}else if(e.code===de.f2){if(Pe.isDisplayFavorites)return;Y.hide(),Ne.modalMessageCreateFolder.show(),Ne.modalMessageCreateFolder.focus()}else if(e.code===de.f3){if(!i.data.value)return;Pe.isDisplayFavorites?(Be.favoritesStorage=Be.favoritesStorage.filter(function(e){return e.path!==i.data.value.item.path}),Pe.currentDirFilesCount=Be.favoritesStorage.length,w(Z,y({dirs:[],files:Be.favoritesStorage},1),7,7,te,{
focusIndex:i.index>=Be.favoritesStorage.length?i.index-1:i.index})):9!==i.data.value.type&&10!==i.data.value.type||Pe.isDisplayShares&&i.data.value.item.subtype!==re.playlistStream||C()}else e.code===de.f4&&Ue[Me.ACTION_SEARCH]();else 2===Pe.type&&2.2===Pe.last().type&&e.code===de.menu&&(q.init({data:k("00001000"),size:1,focusIndex:0}),Z.$focusItem.index&&Ne.modalMessageActions.show());else e.code===de.menu&&(i&&5===i.data.value.deviceType?(q.init({data:k("00000110"),size:2,focusIndex:0}),Ne.footer.hide(),Ne.modalMessageActions.show()):i.data.value&&1===i.data.value.type&&(q.init({data:k("00000001"),size:1,focusIndex:0}),Ne.footer.hide(),Ne.modalMessageActions.show()))}),function(){var e,t=core.environment.onFocusDebounceTimeout,i=[];Z.addListener("focus:item",function(){var n,s=Z.$focusItem;H&&(clearTimeout(e),n=H[s.index],n&&n.value?e=setTimeout(function(){if(10===n.value.type){switch(n.value.item.subtype){case re.playlistFile:S("01000001",[null,n.value.name,null,null,null,null,null,n.value.item.uri]),i=[{type:"f4",title:gettext("Search"),action:function(){}}],Pe.isDisplayShares||i.unshift({type:"f3",title:gettext(n.value.isFavorite?"Remove from favorites":"Add to favorites"),action:function(){}});break;case re.playlistStream:S("01000001",[null,n.value.name,null,null,null,null,null,n.value.item.path]),i=[{type:"f3",title:gettext(n.value.isFavorite?"Remove from favorites":"Add to favorites"),action:function(){}},{type:"f4",title:gettext("Search"),action:function(){}}];break;default:"11"===n.value.item.type?I(n.value.item):S("0111000",[null,n.value.name,new Date(n.value.item.last_modified).toLocaleDateString(),be(n.value.item.size).singleObject,null,null,null]),i=[{type:"f3",title:gettext("Add to favorites"),action:function(){}},{type:"f4",title:gettext("Search"),action:function(){}}],!Pe.isDisplayFavorites&&i.unshift({type:"f2",title:gettext("Create folder"),action:function(){}}),!Pe.isDisplayFavorites&&i.unshift({type:"f1",title:gettext("Delete"),action:function(){}})}Ne.footer.init(i)}else S("0100000",[null,n.value.name,null,null,null,null,null]),Ne.footer.init([{type:"f1",title:gettext("Delete"),action:function(){}},{type:"f2",title:gettext("Create folder"),action:function(){}},{type:"f4",title:gettext("Search"),action:function(){}}])},t):(S("1000000",[Pe.currentDirFilesCount+"",null,null,null,null,null,null]),i=[{type:"f4",title:gettext("Search"),action:function(){}}],!Pe.isDisplayFavorites&&!Pe[Pe.length-1].isDisplayPlaylist&&i.unshift({type:"f2",title:gettext("Create folder"),action:function(){}}),Ne.footer.init(i))),(2===Pe.type&&2===Pe.length||7===Pe.type)&&(Ne.footer.init([{type:"f4",title:gettext("Search"),action:Ue[Me.ACTION_SEARCH]}]),Ne.footer.show(),7===Pe.type&&Pe.stageType>7.1&&(clearTimeout(e),e=setTimeout(function(){s.index?S("010"+ +(10===s.value.type)+"000"+ +(10===s.value.type),[null,s.value.name,null,10===s.value.type?be(s.value.item.size).singleObject:null,null,null,null,10===s.value.type?s.value.item.path:null]):S("0000000",[null,null,null,null,null,null,null])},t))),Pe.type||(clearTimeout(e),e=setTimeout(function(){s.data&&s.data.value&&8===s.data.value.deviceType?(Ne.footer.hide(),S("0000110",[null,null,null,null,s.data.value.sizeOverview,s.data.value.fsType,null]),z({size:s.data.value.fullSize,free:s.data.value.freeSize})):s.data&&s.data.value&&5===s.data.value.deviceType?(b(s.data.value),Ne.footer.init([{type:"f1",title:gettext("Delete"),action:function(){De({title:gettext("Are you sure you want to delete this share?"),icon:"info",type:"",buttons:[{value:gettext("Cancel"),click:function(){}},{value:gettext("Ok"),click:function(){T()}}]})}},{type:"f4",title:gettext("Rename"),action:Ue[Me.ACTION_RENAME_SMB]}]),Ne.footer.show()):s.data&&s.data.value&&1===s.data.value.type?(Ne.footer.init([{type:"f1",title:gettext("Clear"),action:Ue[Me.ACTION_CLEAR_FAV]}]),Ne.footer.show(),$()):(Ne.footer.hide(),S("0000000",[null,null,null,null,null,null,null]))},t))})}(),Z.addListener("move:view",function(){Z&&Z.$focusItem&&Z.emit("focus:item")}),P.addListener("click",function(){var e,t=a.value.slice(0,255),i=/^(?:[\w\d]+[\w\d ]*)+$/;t.trim()?i.test(t)?(e=M()+t,Ae.isFolderExist(e,function(i,n){n?De({title:gettext("Folder with this name already exists"),icon:"info"}):(Ae.createDir(e,function(e,i){w(Z,(H.splice(Z.$focusItem.index+1,0,{items:[{value:"R",className:"icon iconFileManager"},{value:t,className:"listDirNameField"},{value:"B",className:"icon iconFileManager favoritesStar"}],value:{name:t,type:9},click:function(){Pe.push({index:Z.$focusItem.index,path:t}),Ae.readDir(M(),function(e,t){Pe.currentDirFilesCount=t.dirs.length+t.files.length,w(Z,y(t,1),7,7,null,{focusIndex:0}),S("1000100",[Pe.currentDirFilesCount+"",null,null,null,be(Pe.currentDevice.size,Pe.currentDevice.freeSize).overview,null,null])})}}),H),7,7,te,{focusIndex:Z.$focusItem.index+1})}),_())})):De({title:gettext("Sorry, could not set folder name to")+' "'+t+'". '+gettext("Unsupported symbols"),icon:"info"}):De({title:gettext("Folder name can not be empty"),icon:"info"})}),P.addListener("keydown",function(e){e.code===de.up&&(5===Pe.currentDeviceType?n:a).focus()}),j.addListener("click",function(){E(n.value),_()}),j.addListener("keydown",function(e){e.code===de.up&&n.focus()}),N.addListener("click",function(){var e,t,i=oe.address.value,n=oe.folder.value,a=oe.name;return i&&n&&a?(i=i+"/"+n,i=i.split("/").filter(function(e){return e}),e=i[0],n=i[1],i="//"+e+"/"+n,t={address:i,folder:n,mountPath:le},oe.login&&(t.login=oe.login.value,t.password=oe.password.value),Ae.umount({force:!0,path:le},function(){}),void s(t,function(t,s){var a;s?(a={name:oe.name.value||n,address:i,server:e,type:2},oe.login&&(a.login=oe.login.value,a.password=oe.password.value),Be.sharesStorage.push(a),_(),w(Z,D(),7,7,te,Z.$focusItem?{focusIndex:Z.$focusItem.index}:null)):De({title:gettext("Unable to connect to the resource with the given parameters"),icon:"alert",type:"warning"})})):De({title:gettext("Wrong connection parameters"),icon:"alert",type:"warning"})}),N.addListener("keydown",function(e){var t=Ne.modalMessageMountShare.children[0].visible?Ne.modalMessageMountShare.children[0]:Ne.modalMessageMountShare.children[1];switch(e.code){case de.up:t.focus(),t.focusIndex(t.data.length-1);break;case de.down:t.focus(),t.focusIndex(0)}}),Q.addListener("click",function(){var e=ee.value,t=se.value,i=Z.$focusItem.data,n=i.value.details||i.value.item,s={address:n.address,folder:n.name,login:e,password:t,mountPath:le};n.login=e,n.password=t,f("openShare",s,{})}),Q.addListener("keydown",function(e){e.code===de.up&&(U.focus(),U.focusIndex(1))}),Ae.onMount=function(e){e?(Fe=Ae.getMountPoints(),Pe.type||w(Z,D(),7,7,te,Z.$focusItem?{focusIndex:Z.$focusItem.index}:null)):(Fe=Ae.getMountPoints(),Pe.type?8===Pe.stageType&&Ae.isFolderExist(Pe.currentDevice.mountPath,function(e,t){var i,n;t||(n=D(),i=Pe.entryPointIndex,m(),Ne.footer.hide(),w(Z,n,7,7,te,{focusIndex:D.itemsLength===i?i-1:i}))}):w(Z,D(),7,7,te,{focusIndex:D.itemsLength===Pe.entryPointIndex?Pe.entryPointIndex-1:Pe.entryPointIndex}))}}function z(e){function t(){var e=Te.querySelector(".component.list .item.focus"),t=Te.querySelector(".panelEx.main"),i=window.getComputedStyle(e).getPropertyValue("background-color"),n=window.getComputedStyle(t).getPropertyValue("background-color"),s=window.getComputedStyle(t).getPropertyValue("color");return n=n.replace(/(?:0\.)?\d+/g,function(e){return~~(1.2*e)}),{inUseSpace:i,freeSpace:n,text:s}}var i,n,s,a,o,l,r,c=Te.createElement("div"),d=Te.createElement("canvas"),u=c.cloneNode(!1),h=d.getContext("2d"),p=t(),f=0,m=[e.size-e.free,e.free],v=0,g=[p.inUseSpace,p.freeSpace];for(z.indicators||(l=c.cloneNode(!1),r=c.cloneNode(!1),o=c.cloneNode(!1),s=Te.createTextNode(gettext("in use")),a=Te.createTextNode(gettext("free")),o.className="cntIndicators",r.className="allocSpaceElem",l.className="freeSpaceElem",r.style.backgroundColor=g[0],l.style.backgroundColor=g[1],o.appendChild(r),o.appendChild(s),o.appendChild(l),o.appendChild(a),W.$body.children[0].appendChild(o),z.indicators=!0),z.diagram&&(Te.querySelector(".infoStorageDiagram").parentNode.removeChild(z.diagram),z.diagram=null),c.className="infoStorageDiagram",u.innerText=~~(100*(e.size-e.free)/e.size)+"%",u.style.color=p.text,c.appendChild(d),c.appendChild(u),W.$body.children[0].appendChild(c),i=0,n=m.length;n>i;i+=1)v+=m[i];for(d.width=d.height=W.$node.offsetHeight/2.4,i=0,n=m.length;n>i;i+=1)h.fillStyle=g[i],h.beginPath(),h.moveTo(d.width/2,d.height/2),h.arc(d.width/2,d.height/2,d.height/2,f,f+2*Math.PI*(m[i]/v),!1),h.lineTo(d.width/2,d.height/2),h.fill(),f+=2*Math.PI*(m[i]/v);z.diagram=c}function _(){Ne.modalMessageSort.hide(),Ne.modalMessageFilter.hide(),Ne.modalMessageActions.hide(),Ne.modalMessageShareType.hide(),Ne.modalMessageMountShare.hide(),Ne.modalMessageRenameShare.hide(),Ne.modalMessageCreateFolder.hide(),Ne.modalMessageSambaAuthorize.hide(),Y.focus(),Ee=!1,f.openShareAttempts=0,K.$node.classList.contains("active")&&Ne.footer.show()}var R,B,V,H,j,U,Y,G,K,W,X,Z,q,J,Q,ee,te,ie,ne,se,ae,oe,le="/ram/mnt/smb",re={playlistFile:0,playlistStream:1},ce=i(3),de=i(2),ue=i(27),he=i(28),pe=i(9),fe=i(10),me=i(29),ve=i(22),ge=i(25),ye=i(21),xe=i(30),we=i(12),be=i(16),$e=i(31),Ie=i(24),Se=i(23),ke=i(7),Ce=i(14),Ne=new(i(11))({$node:window.pageMain}),Te=document,Ee=!1,De=core.notify,Me=Ce.mediaAction,Ae=core.plugins.fs,Le=i(15)(we),Oe=core.plugins.ufsJson,Fe=Ae.getMountPoints(),Pe=[],ze={},_e=[],Re=[],Be={},Ve={},He={},je=[],Ue={};Pe.type=0,Pe.last=function(){return this[this.length-1]},se={0:"Unknown",1:"FAT16",2:"FAT32",3:"EXT2",4:"EXT3",5:"NTFS",6:"EXT4"},He={5:{ext:["mpg","mpeg","mov","mp4","avi","mkv","3gp","ts","vob","wmv","mts","m2t","m2v","divx","m2ts","m2p","tp","flv","mod","tod","asf","tts","m4v"],ico:"b"},6:{ext:["mp3","wav","ac3","ogg","oga","aiff","wv","tta","wma","aac","dts","flac","ape","m4a"],ico:"a"},7:{ext:["jpg","jpeg","png","bmp","tif","tiff"],ico:"e"},8:{ext:["txt","srt","sub","ass"],ico:"d"},11:{ext:["cue"],ico:"i"},12:{ext:["iso"],ico:"h"},13:{ext:["tspinf"],ico:"g"},14:{ext:["m3u","m3u8"],ico:"j"},15:{ext:[""],ico:"e"}},ee={5:"content/video",6:"content/audio",12:"content/video"},ze={9:n,5:r,6:r,7:c,11:a,12:d,14:o,15:l},f.openShareAttempts=0,Ne.addListener("show",function(){Ne.loaded||(Oe.load(function(e,t){t?(Be.favoritesStorage=t.favoritesStorage||[],Be.sharesStorage=t.sharesStorage||[],Be.sharesStorage.length&&p()):(Be.favoritesStorage=[],Be.sharesStorage=[])}),setTimeout(function(){P([]),Ne.loaded=1,Z.emit("focus:item")},0))}),Ne.addListener("keydown",function(e){switch(e.code){case de.back:Ee?_():Pe.length||Pe.isDisplayFavorites||7===Pe.type?K.$node.classList.contains("active")&&(2===Pe.type&&2===Pe.length?(Pe.pop(),f("getGroups",null,{icon:"T",index:Pe.last().index})):g()):(Y.blur(),ce.exit(function(e){e||Y.focus(),Oe.saveSync(Be)}))}}),e.exports=Ne},function(module,exports,__webpack_require__){"use strict";var Emitter=__webpack_require__(4),gettext=new Emitter,meta=null,data=null;gettext.load=function(e,t){var i=new XMLHttpRequest;e.ext=e.ext||"json",e.path=e.path||"lang",i.responseType="text",i.onload=function(){var e;try{e=JSON.parse(i.responseText),meta=e.meta,data=e.data,t(null,data)}catch(n){meta=null,data=null,i.onerror(n)}gettext.events.load&&gettext.emit("load")},i.onerror=function(e){t(e),gettext.events.error&&gettext.emit("error")},i.open("GET",e.path+"/"+e.name+"."+e.ext,!0),i.send(null)},window.gettext=function(e){return data&&data[""][e]?data[""][e]:e},window.pgettext=function(e,t){return data&&data[e][t]?data[e][t]:t},window.ngettext=function(msgId,plural,value){return data&&meta?data[""][msgId][eval("var n = "+value+"; "+meta.plural)]:1===value?msgId:plural},module.exports=gettext},function(e,t,i){"use strict";function n(e){s.call(this),this.data=e||{}}var s=i(4);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.idName="id",n.prototype.clear=function(){var e=this.data;return Object.keys(e).length>0?(this.data={},this.events.clear&&this.emit("clear",{data:e}),!0):!1},n.prototype.init=function(e){return e?(this.clear(),this.data=e,this.events.init&&this.emit("init",{data:e}),!0):!1},n.prototype.has=function(e){return this.data.hasOwnProperty(e)},n.prototype.get=function(e){return this.data[e]},n.prototype.set=function(e,t){var i=e in this.data,n={name:e,curr:t};return i?(n.prev=this.data[e],t!==n.prev?(this.data[e]=t,this.events.change&&this.emit("change",n),!0):!1):(this.data[e]=t,this.events.change&&this.emit("change",n),!0)},n.prototype.unset=function(e){var t,i=e in this.data;return i?(t={name:e,prev:this.data[e]},delete this.data[e],this.events.change&&this.emit("change",t),!0):!1},e.exports=n},function(e,t){"use strict";if(!("classList"in document.documentElement)){var i=Array.prototype,n=i.indexOf,s=i.slice,a=i.push,o=i.splice,l=i.join;window.DOMTokenList=function(e){if(this._element=e,e.className!==this._classCache){if(this._classCache=e.className,!this._classCache)return;var t,i=this._classCache.replace(/^\s+|\s+$/g,"").split(/\s+/);for(t=0;t<i.length;t++)a.call(this,i[t])}},window.DOMTokenList.prototype={add:function(e){this.contains(e)||(a.call(this,e),this._element.className=s.call(this,0).join(" "))},contains:function(e){return-1!==n.call(this,e)},item:function(e){return this[e]||null},remove:function(e){var t=n.call(this,e);-1!==t&&(o.call(this,t,1),this._element.className=s.call(this,0).join(" "))},toString:function(){return l.call(this," ")},toggle:function(e){return this.contains(e)?this.remove(e):this.add(e),this.contains(e)}},Object.defineProperty(Element.prototype,"classList",{get:function(){return new window.DOMTokenList(this)}})}},function(e,t,i){"use strict";function n(e){e=e||{},e.className="button "+(e.className||""),s.call(this,e),e.icon&&(this.$icon=this.$body.appendChild(document.createElement("div")),this.$icon.className="icon "+e.icon),this.$text=this.$body.appendChild(document.createElement("div")),this.$text.classList.add("text"),e.value&&(this.$text.innerText=e.value)}var s=i(1),a=i(2);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.clickDuration=200,n.prototype.defaultEvents={click:function(){var e=this;this.$node.classList.add("click"),setTimeout(function(){e.$node.classList.remove("click")},this.clickDuration)},keydown:function(e){e.code===a.ok&&this.events.click&&this.emit("click",{event:e})}},e.exports=n},function(e,t,i){"use strict";function n(e){e.className="checkList "+(e.className||""),s.call(this,e),this.addListener("click:item",function(e){var t=e.$item;t.checkBox.set(!t.checkBox.value),t.state=t.checkBox.value})}var s=i(6),a=i(8);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.renderItemDefault=function(e,t){var i=document.createElement("table"),n=document.createElement("tr"),s=document.createElement("td"),o=new a({value:t.state||!1});e.innerHTML="",i.appendChild(n),s.appendChild(o.$node),s.className="checkBoxWrapper",n.appendChild(s),s=document.createElement("td"),s.className="title",s.innerText=t.title||"",n.appendChild(s),e.checkBox=o,e.state=o.value,e.value=t.value,e.appendChild(i)},n.prototype.renderItem=n.prototype.renderItemDefault,e.exports=n},function(e,t,i){"use strict";function n(e){function t(){var e=new Date,t=(e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours()),n=e.getMinutes();i.innerText=(t>9?t:"0"+t)+":"+(n>9?n:"0"+n)}var i=document.createElement("div");e=e||{},e.focusable=!1,e.className="clock "+(e.className||""),e.visible=e.visible||!0,s.call(this,e),t(),setInterval(t,1e3),this.$node.appendChild(i)}var s=i(1);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,e.exports=n},function(e,t,i){"use strict";function n(e){var t;e=e||{},e.focusable=!1,e.className="footer "+(e.className||""),e.visible=e.visible||!1,e.$body=document.createElement("div"),e.$body.className="body",s.call(this,e),this.tabs=[],this.tab=0,this.$node.appendChild(o.tag("table",{},o.tag("tr",{},o.tag("td",{},o.tag("div",{className:"icon menu"})),o.tag("td",{className:"central"},this.tabs[0]=o.tag("div",{className:"wrapper hidden"},o.tag("div",{className:"button"},o.tag("div",{className:"iconImg"}),o.tag("div",{className:"title"}))),this.tabs[1]=o.tag("div",{className:"wrapper hidden"},o.tag("div",{className:"button"},o.tag("div",{className:"iconImg"}),o.tag("div",{className:"title"})),o.tag("div",{className:"button"},o.tag("div",{className:"iconImg"}),o.tag("div",{className:"title"}))),this.tabs[2]=o.tag("div",{className:"wrapper hidden"},o.tag("div",{className:"button"},o.tag("div",{className:"iconImg"}),o.tag("div",{className:"title"})),o.tag("div",{className:"button"},o.tag("div",{className:"iconImg"}),o.tag("div",{className:"title"})),o.tag("div",{className:"button"},o.tag("div",{className:"iconImg"}),o.tag("div",{className:"title"}))),this.tabs[3]=o.tag("div",{className:"wrapper hidden"},o.tag("div",{className:"button"},o.tag("div",{className:"iconImg"}),o.tag("div",{className:"title"})),o.tag("div",{className:"button"},o.tag("div",{className:"iconImg"}),o.tag("div",{className:"title"})),o.tag("div",{className:"button"},o.tag("div",{className:"iconImg"}),o.tag("div",{className:"title"})),o.tag("div",{className:"button"},o.tag("div",{className:"iconImg"}),o.tag("div",{className:"title"})))),o.tag("td",{},this.$info=o.tag("div",{className:"icon info"}))))),this.init(e.data),t=this,this.parent.addListener("keydown",function(e){var i=t.tabs[t.tab];if(t.visible)switch(e.code){case a.f1:i.f1&&"function"==typeof i.f1.action&&i.f1.action();break;case a.f2:i.f2&&"function"==typeof i.f2.action&&i.f2.action();break;case a.f3:i.f3&&"function"==typeof i.f3.action&&i.f3.action();break;case a.f4:i.f4&&"function"==typeof i.f4.action&&i.f4.action();break;case a.menu:i.menu&&"function"==typeof i.menu.action&&i.menu.action();break;case a.info:"none"!==t.$info.style.display&&(i.classList.contains("hidden")?i.classList.remove("hidden"):i.classList.add("hidden"))}})}var s=i(1),a=(i(11),i(2)),o=i(7);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.init=function(e){var t,i=!this.tabs[this.tab].classList.contains("hidden"),n=0;for(e=e||[],this.tabs[this.tab].classList.add("hidden"),this.$info.style.display="none",e.forEach(function(e){-1!==["f1","f2","f3","f4"].indexOf(e.type)&&n++}),this.tab=0===n?0:n-1,n=0,this.tabs[this.tab].f1&&(this.tabs[this.tab].f1.action=null),this.tabs[this.tab].f2&&(this.tabs[this.tab].f2.action=null),this.tabs[this.tab].f3&&(this.tabs[this.tab].f3.action=null),this.tabs[this.tab].f4&&(this.tabs[this.tab].f4.action=null),this.tabs[this.tab].menu&&(this.tabs[this.tab].menu.action=null),t=0;t<e.length;t++)this.tabs[this.tab][e[t].type]={action:e[t].action},"menu"!==e[t].type&&(this.tabs[this.tab].children[n].children[0].className="iconImg "+e[t].type,this.tabs[this.tab].children[n].children[1].innerText=e[t].title,n++);n&&(this.$info.style.display="block"),i&&n&&this.tabs[this.tab].classList.remove("hidden")},e.exports=n},function(e,t,i){"use strict";function n(e){e=e||{},this.value="",this.type=this.TYPE_TEXT,e.className="input "+(e.className||""),e.maxlength=e.maxlength||0,this.autoKeyboard=!0,"undefined"!=typeof e.autoKeyboard&&(this.autoKeyboard=!!e.autoKeyboard),s.call(this,e),this.$line=this.$body.appendChild(document.createElement("div")),this.$line.className="line",this.$caret=this.$line.appendChild(document.createElement("div")),this.$caret.className="caret",this.$placeholder=this.$line.appendChild(document.createElement("div")),this.$placeholder.className="placeholder",this.$caret.index=0,this.init(e),this.autoKeyboard&&(this.addListener("focus",function(){var e=this.$node.getBoundingClientRect();screen.height/2>e.top+e.height?stbWindowMgr.SetVirtualKeyboardCoord("none",e.left,e.top+e.height):stbWindowMgr.SetVirtualKeyboardCoord("none",e.left,e.top-e.height/4-o.data.metrics.keyboardHeight),gSTB.ShowVirtualKeyboard()}),this.addListener("blur",function(){gSTB.IsVirtualKeyboardActive()&&gSTB.HideVirtualKeyboard()}))}var s=i(1),a=i(2),o=i(3);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.TYPE_TEXT=0,n.prototype.TYPE_PASSWORD=1,n.prototype.defaultEvents={keypress:function(e){this.addChar(String.fromCharCode(e.keyCode),this.$caret.index)},keydown:function(e){switch(e.code){case a["delete"]:this.removeChar(this.$caret.index);break;case a.back:this.removeChar(this.$caret.index-1);break;case a.left:this.setCaretPosition(this.$caret.index-1);break;case a.right:this.setCaretPosition(this.$caret.index+1);break;case a.end:case a.down:this.setCaretPosition(this.value.length);break;case a.home:case a.up:this.setCaretPosition(0)}}},n.prototype.init=function(e){e.type&&(this.type=e.type),e.value&&this.setValue(e.value),e.placeholder&&(this.$placeholder.innerText=e.placeholder),this.maxlength=e.maxlength,this.$line.dir=e.direction||"ltr"},n.prototype.addChar=function(e,t){var i=document.createElement("div");t=void 0===t?this.$caret.index:t,0===this.value.length&&this.$line.removeChild(this.$placeholder),(!this.maxlength||t<=this.maxlength)&&(i.className="char",this.value=this.value.substring(0,t)+e+this.value.substring(t,this.value.length),++this.$caret.index,this.type===this.TYPE_PASSWORD?i.innerText="*":" "===e?i.innerHTML="&nbsp;":i.innerText=e,t>=this.value.length?(this.$line.appendChild(i),this.$line.appendChild(this.$caret)):(this.$line.insertBefore(this.$caret,this.$line.children[t]),this.$line.insertBefore(i,this.$caret)),this.events.input&&this.emit("input",{value:this.value}))},n.prototype.removeChar=function(e){var t=this.value;e=void 0===e?this.$caret.index-1:e,this.value.length>0&&(this.$caret.index===e&&e<this.value.length?this.$line.removeChild(this.$line.children[e+1]):this.$caret.index>e&&(--this.$caret.index,this.$line.removeChild(this.$line.children[e])),this.value=this.value.substring(0,e)+this.value.substring(e+1,this.value.length),this.events.input&&t!==this.value&&this.emit("input",{value:this.value})),0===this.value.length&&this.$line.appendChild(this.$placeholder)},n.prototype.setCaretPosition=function(e){e>=0&&e<=this.value.length&&this.$caret.index!==e&&(this.$line.removeChild(this.$caret),e===this.value.length?this.$line.appendChild(this.$caret):this.$line.insertBefore(this.$caret,this.$line.children[e]),this.$caret.index=e)},n.prototype.setValue=function(e){var t,i,n=this.value.length,s=e.length,a=0;if(e!==this.value){if(s>0){if(this.$placeholder.parentNode===this.$line&&this.$line.removeChild(this.$placeholder),this.$line.removeChild(this.$caret),s!==n)if(i=s-n,i>0)for(a=0;i>a;a++)t=this.$line.appendChild(document.createElement("div")),t.className="char";else for(a=0;a>i;a--)this.$line.removeChild(this.$line.lastChild);for(a=0;s>a;a++)t=this.$line.children[a],this.type===this.TYPE_PASSWORD?t.innerHTML="*":" "===e[a]?t.innerHTML="&nbsp;":t.innerText=e[a];this.value=e,this.$caret.index=s,this.$line.appendChild(this.$caret)}else this.value="",this.$line.innerText="",this.$line.appendChild(this.$caret),this.$line.appendChild(this.$placeholder),this.$caret.index=0;this.events.input&&this.emit("input",{value:this.value})}},e.exports=n},function(e,t,i){"use strict";function n(e){e=e||{},this.focusIndex=0,e.className="layout "+(e.className||""),this.data=[],a.call(this,e),this.init(e),this.addListener("keydown",function(e){switch(e.code){case o.right:this.children.length&&this.focusIndex<this.children.length-1&&this.children[++this.focusIndex].focus();break;case o.left:this.children.length&&this.focusIndex>0&&this.children[--this.focusIndex].focus();break;case o.back:this.parent.focus(),this.parent&&this.$parentItem&&this.parent.focusItem(this.$parentItem)}})}function s(e){var t,i;for(t=0;t<e.length;t++)i=e[t],"object"!=typeof i?e[t]={value:e[t],wrap:!0}:i instanceof a||i instanceof HTMLElement?e[t]={value:i,wrap:!1}:e[t].wrap=!0;return e}var a=i(1),o=i(2);n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.prototype.init=function(e){for(var t,i,n,o=this,l=s(e.data);this.$node.firstChild;)this.$node.removeChild(this.$node.firstChild);for(this.data=l,n=0;n<l.length;n++)t=l[n],"string"==typeof t.value?(i=document.createElement("div"),i.textContent=t.value,t.className&&(i.className=t.className),this.$node.appendChild(i)):t.value instanceof HTMLElement?t.wrap?(i=document.createElement("div"),t.className&&(i.className=t.className),i.appendChild(t.value),this.$node.appendChild(i)):this.$node.appendChild(t.value):t.value instanceof a&&(t.value.propagate=!0,t.value.index=this.children.length,t.value.addListener("click",function(){o.focusIndex=this.index}),t.wrap?(i=document.createElement("div"),t.className&&(i.className=t.className),i.appendChild(t.value.$node),this.$node.appendChild(i),this.children.push(t.value),t.value.parent=this):this.add(t.value))},e.exports=n},function(e,t,i){"use strict";function n(e){var t;e=e||{},this.size=1,this.main=!1,this.index=0,e.className="panelEx "+(e.className||""),e.$body=document.createElement("div"),e.$body.className="body",s.call(this,e),e.size&&(this.size=e.size,this.$node.classList.add("size"+e.size)),e.main&&(this.main=!0,this.$node.classList.add("main")),this.$shadow={left:document.createElement("div"),right:document.createElement("div")},this.$shadow.left.className="shadow left",this.$node.appendChild(this.$shadow.left),this.$shadow.right.className="shadow right",this.$node.appendChild(this.$shadow.right),e.title&&(this.$title=document.createElement("div"),this.$title.className="title",this.$title.innerText=e.title,this.$node.appendChild(this.$title)),this.$node.appendChild(this.$body),t=document.createElement("div"),t.className="overlay",this.$node.appendChild(t)}var s=i(1);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.defaultEvents={focus:function(){this.children.length&&this.children[0].focus()}},n.prototype.focus=function(){this.parent.panels[this.parent.focusIndex].$node.classList.remove("active"),this.parent.panels[this.parent.focusIndex].$node.classList.remove("top"),s.prototype.focus.call(this),this.parent.focusIndex=this.index,this.$node.classList.add("active"),this.$node.classList.add("top"),0===this.index&&this.parent.panels[1]&&this.parent.panels[1].main?(this.parent.panels[1].$node.classList.remove("position-left"),this.parent.panels[1].$node.classList.add("position-right"),this.parent.panels[2]&&this.parent.panels[2].$node.classList.remove("expand"),this.$node.classList.add("expand")):2===this.index&&this.parent.panels[1].main&&(this.parent.panels[1].$node.classList.remove("position-right"),this.parent.panels[1].$node.classList.add("position-left"),this.parent.panels[0].$node.classList.remove("expand"),this.$node.classList.add("expand"))},n.prototype.blur=function(){this.parent.panels[this.parent.focusIndex].$node.classList.remove("active"),s.prototype.blur.call(this)},e.exports=n},function(e,t,i){"use strict";function n(e){function t(e){switch(e.code){case a.left:n.focusIndex>0&&n.panels[n.focusIndex-1].focus();break;case a.right:n.focusIndex<n.panels.length-1&&n.panels[n.focusIndex+1].focus()}}var i,n=this;for(e=e||{},e.focusable=e.focusable||!1,e.className="panelSet "+(e.className||""),s.call(this,e),this.panels=e.panels,this.focusIndex=0,e.panels&&!e.panels[0].main&&(e.panels[0].$node.classList.add("left"),e.panels[0].$node.classList.add("expand")),e.panels&&e.panels[1]&&e.panels[1].main&&e.panels[1].$node.classList.add("position-right"),e.panels&&e.panels[2]&&e.panels[1].main&&e.panels[2].$node.classList.add("right"),e.panels&&this.add.apply(this,e.panels),i=0;i<this.panels.length;i++)this.panels[i].addListeners({keydown:t}),this.panels[i].index=i}var s=i(1),a=i(2);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.drawShadow=function(){var e,t,i;for(e=0;e<this.panels.length;e++)e>0&&(this.panels[e].$node.classList.add("leftShadow"),t=this.panels[e-1].$node.offsetHeight,i=this.panels[e-1].$node.offsetTop-this.panels[e].$node.offsetTop,this.panels[e].$node.offsetHeight>t?(this.panels[e].$shadow.left.style.height=this.panels[e-1].$node.offsetHeight+"px",this.panels[e].$shadow.left.style.top=i+"px"):this.panels[e].$shadow.left.style.height=this.panels[e].$node.offsetHeight+"px"),e<this.panels.length-1&&(this.panels[e].$node.classList.add("rightShadow"),t=this.panels[e+1].$node.offsetHeight,i=this.panels[e+1].$node.offsetTop-this.panels[e].$node.offsetTop,this.panels[e].$node.offsetHeight>t?(this.panels[e].$shadow.right.style.height=this.panels[e-1].$node.offsetHeight+"px",this.panels[e].$shadow.right.style.top=i+"px"):this.panels[e].$shadow.right.style.height=this.panels[e].$node.offsetHeight+"px")},n.prototype.focus=function(){s.prototype.focus.call(this),this.panels[this.focusIndex].focus()},n.prototype.blur=function(){this.panels[this.focusIndex].blur()},e.exports=n},function(e,t,i){"use strict";function n(e){var t=this;this.group="group "+o++,this.$checkedData=null,e.className="radioList "+(e.className||""),s.call(this,e),this.addListener("click:item",function(e){var i=e.$item;i.checkBox.set(!0),i.state=i.checkBox.value,i.data.state=i.checkBox.value,t.$checkedData!==i.data&&(t.emit("select",{$last:t.$checkedData,$curr:i}),t.$checkedData.state=!1,t.$checkedData=i.data)})}var s=i(6),a=i(8),o=0;n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.group=0,n.prototype.renderItemDefault=function(e,t){var i=document.createElement("table"),n=document.createElement("tr"),s=document.createElement("td"),o=new a({group:this.group});e.innerHTML="",t.state&&o.set(!0),i.appendChild(n),s.appendChild(o.$node),s.className="checkBoxWrapper",n.appendChild(s),s=document.createElement("td"),s.className="title",s.innerText=t.title||"",n.appendChild(s),e.checkBox=o,e.state=o.value,e.value=t.value,e.appendChild(i)},n.prototype.setData=function(e){var t;for(s.prototype.setData.call(this,e),t=0;t<this.data.length;t++)if(this.data[t].state){this.$checkedData=this.data[t];break}},n.prototype.renderItem=n.prototype.renderItemDefault,e.exports=n},function(e,t,i){"use strict";function n(e){e=e||{},e.className=" scrollArea "+(e.className||""),e.$body=document.createElement("div"),e.$body.className="body",this.step=5,this.realHeight=0,this.viewHeight=0,this.topPosition=0,this.scroll=null,s.call(this,e),this.$node.appendChild(this.$body),this.init(e)}var s=i(1),a=i(3),o=i(2);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.defaultEvents={keydown:function(e){switch(e.code){case o.up:case o.down:this.move(e.code)}}},n.prototype.move=function(e){if(!(this.realHeight<=this.viewHeight))switch(e){case o.down:if(this.topPosition-this.step*a.data.metrics.height/100<this.viewHeight-this.realHeight)return this.topPosition=this.viewHeight-this.realHeight,this.$body.style.top=this.topPosition+"px",this.emit("overflow",{direction:e}),void(this.scroll&&this.scroll.scrollTo(-this.topPosition));this.topPosition-=this.step*a.data.metrics.height/100,this.scroll&&this.scroll.scrollTo(-this.topPosition),this.$body.style.top=this.topPosition+"px";break;case o.up:if(this.topPosition+this.step*a.data.metrics.height/100>0)return this.topPosition=0,this.$body.style.top=this.topPosition+"px",this.emit("overflow",{direction:e}),void(this.scroll&&this.scroll.scrollTo(-this.topPosition));this.topPosition+=this.step*a.data.metrics.height/100,this.scroll&&this.scroll.scrollTo(-this.topPosition),this.$body.style.top=this.topPosition+"px"}},n.prototype.init=function(e){e=e||{},this.realHeight=this.$body.offsetHeight,this.viewHeight=this.$node.offsetHeight,this.topPosition=0,this.$body.style.top=this.topPosition+"px",e.scroll&&(this.scroll=e.scroll),e.step&&(this.step=e.step),this.scroll&&this.scroll.init({realSize:this.realHeight,viewSize:this.viewHeight,value:this.topPosition})},e.exports=n},function(e,t,i){"use strict";function n(e){e=e||{},this.viewSize=10,this.realSize=100,this.value=0,this.type=this.TYPE_VERTICAL,this.thumbRect=null,this.trackRect=null,e.focusable=e.focusable||!1,e.className="scrollBar "+(e.className||""),e.type&&(this.type=e.type),this.type===this.TYPE_HORIZONTAL&&(e.className+=" horizontal"),
s.call(this,e),this.$thumb=this.$body.appendChild(document.createElement("div")),this.$thumb.className="thumb",this.init(e)}var s=i(1);n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.TYPE_VERTICAL=1,n.prototype.TYPE_HORIZONTAL=2,n.prototype.init=function(e){e=e||{},void 0!==e.realSize&&(this.realSize=e.realSize),void 0!==e.viewSize&&(this.viewSize=e.viewSize),this.viewSize>=this.realSize?this.$thumb.classList.add("hidden"):this.$thumb.classList.remove("hidden"),void 0!==e.value&&this.scrollTo(e.value),this.type===this.TYPE_VERTICAL?this.$thumb.style.height=this.viewSize/this.realSize*100+"%":this.$thumb.style.width=this.viewSize/this.realSize*100+"%",this.thumbRect=this.$thumb.getBoundingClientRect(),this.trackRect=this.$node.getBoundingClientRect()},n.prototype.scrollTo=function(e){return this.value!==e?(0!==this.thumbRect.height&&0!==this.thumbRect.width||(this.trackRect=this.$node.getBoundingClientRect(),this.thumbRect=this.$thumb.getBoundingClientRect()),this.type===this.TYPE_VERTICAL?this.$thumb.style.marginTop=(this.trackRect.height-this.thumbRect.height)*e/(this.realSize-this.viewSize)+"px":this.$thumb.style.marginLeft=(this.trackRect.width-this.thumbRect.width)*e/(this.realSize-this.viewSize)+"px",this.events.change&&this.emit("change",{curr:e,prev:this.value}),e>=this.realSize&&(e=this.realSize,this.events.done&&this.emit("done")),this.value=e,!0):!1},e.exports=n},function(e,t){"use strict";e.exports={480:{height:480,width:720,availTop:24,availBottom:24,availRight:32,availLeft:48,keyboardWidth:558,keyboardHeight:311},576:{height:576,width:720,availTop:24,availBottom:24,availRight:26,availLeft:54,keyboardWidth:558,keyboardHeight:311},720:{height:720,width:1280,availTop:30,availBottom:30,availRight:40,availLeft:40,keyboardWidth:818,keyboardHeight:311},1080:{height:1080,width:1920,availTop:45,availBottom:45,availRight:60,availLeft:60,keyboardWidth:1227,keyboardHeight:467}}},function(e,t){"use strict";e.exports=function(e,t){function i(i,l){var r=function(r,c){return r?(n=!0,void("function"==typeof t&&t(r))):(a[l]=c,i.name&&(o[i.name]=c),s++,void(s>=e.length&&"function"==typeof t&&t(null,a,o)))};n||(0===i.length?r(null,i()):i(r))}var n=!1,s=0,a=[],o={};e=Array.isArray(e)?e:[],0===e.length?"function"==typeof t&&t(null,a,o):e.forEach(i)}}]);